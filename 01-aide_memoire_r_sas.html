<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nassab ABDALLAH">
<meta name="author" content="Damien EUZENAT">
<meta name="author" content="Sébastien LI-THIAO-TE">
<meta name="description" content="Un aide-mémoire pour les statisticiens qui connaissent SAS et souhaitent travailler avec R.">

<title>Aide-mémoire SAS - R - Aide-mémoire SAS - R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-aide_memoire_r_sas.html">Introduction</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Aide-mémoire SAS - R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Basculer le mode sombre"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-aide_memoire_r_sas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Trucs et astuces en R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trucs et astuces</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#importation-des-packages" id="toc-importation-des-packages" class="nav-link active" data-scroll-target="#importation-des-packages"><span class="header-section-number">1</span> Importation des packages</a></li>
  <li><a href="#chemin-vers-le-bureau-et-affichage-de-la-date-et-de-lannée" id="toc-chemin-vers-le-bureau-et-affichage-de-la-date-et-de-lannée" class="nav-link" data-scroll-target="#chemin-vers-le-bureau-et-affichage-de-la-date-et-de-lannée"><span class="header-section-number">2</span> Chemin vers le bureau et affichage de la date et de l’année</a></li>
  <li><a href="#création-dune-base-de-données" id="toc-création-dune-base-de-données" class="nav-link" data-scroll-target="#création-dune-base-de-données"><span class="header-section-number">3</span> Création d’une base de données</a></li>
  <li><a href="#manipuler-les-colonnes-de-la-base-de-données" id="toc-manipuler-les-colonnes-de-la-base-de-données" class="nav-link" data-scroll-target="#manipuler-les-colonnes-de-la-base-de-données"><span class="header-section-number">4</span> Manipuler les colonnes de la base de données</a></li>
  <li><a href="#harmoniser-le-format-des-variables" id="toc-harmoniser-le-format-des-variables" class="nav-link" data-scroll-target="#harmoniser-le-format-des-variables"><span class="header-section-number">5</span> Harmoniser le format des variables</a></li>
  <li><a href="#information-sur-la-base-de-données" id="toc-information-sur-la-base-de-données" class="nav-link" data-scroll-target="#information-sur-la-base-de-données"><span class="header-section-number">6</span> Information sur la base de données</a>
  <ul class="collapse">
  <li><a href="#extraire-les-10-première-lignes-de-la-base" id="toc-extraire-les-10-première-lignes-de-la-base" class="nav-link" data-scroll-target="#extraire-les-10-première-lignes-de-la-base"><span class="header-section-number">6.1</span> Extraire les 10 première lignes de la base</a></li>
  <li><a href="#renommer-les-variables" id="toc-renommer-les-variables" class="nav-link" data-scroll-target="#renommer-les-variables"><span class="header-section-number">6.2</span> Renommer les variables</a></li>
  <li><a href="#nombre-de-lignes-et-de-colonnes-dans-la-base" id="toc-nombre-de-lignes-et-de-colonnes-dans-la-base" class="nav-link" data-scroll-target="#nombre-de-lignes-et-de-colonnes-dans-la-base"><span class="header-section-number">6.3</span> Nombre de lignes et de colonnes dans la base</a></li>
  <li><a href="#afficher-les-noms-des-variables-de-la-base" id="toc-afficher-les-noms-des-variables-de-la-base" class="nav-link" data-scroll-target="#afficher-les-noms-des-variables-de-la-base"><span class="header-section-number">6.4</span> Afficher les noms des variables de la base</a></li>
  <li><a href="#création-de-colonnes-et-de-lignes" id="toc-création-de-colonnes-et-de-lignes" class="nav-link" data-scroll-target="#création-de-colonnes-et-de-lignes"><span class="header-section-number">6.5</span> Création de colonnes et de lignes</a></li>
  <li><a href="#supression-de-colonnes-et-de-lignes" id="toc-supression-de-colonnes-et-de-lignes" class="nav-link" data-scroll-target="#supression-de-colonnes-et-de-lignes"><span class="header-section-number">6.6</span> Supression de colonnes et de lignes</a></li>
  </ul></li>
  <li><a href="#formater-les-modalités-des-valeurs" id="toc-formater-les-modalités-des-valeurs" class="nav-link" data-scroll-target="#formater-les-modalités-des-valeurs"><span class="header-section-number">7</span> Formater les modalités des valeurs</a>
  <ul class="collapse">
  <li><a href="#valeur-discrète" id="toc-valeur-discrète" class="nav-link" data-scroll-target="#valeur-discrète"><span class="header-section-number">7.1</span> Valeur discrète</a></li>
  <li><a href="#valeur-continue" id="toc-valeur-continue" class="nav-link" data-scroll-target="#valeur-continue"><span class="header-section-number">7.2</span> Valeur continue</a></li>
  </ul></li>
  <li><a href="#manipuler-des-lignes-et-des-colonnes" id="toc-manipuler-des-lignes-et-des-colonnes" class="nav-link" data-scroll-target="#manipuler-des-lignes-et-des-colonnes"><span class="header-section-number">8</span> Manipuler des lignes et des colonnes</a>
  <ul class="collapse">
  <li><a href="#sélection-de-colonnes" id="toc-sélection-de-colonnes" class="nav-link" data-scroll-target="#sélection-de-colonnes"><span class="header-section-number">8.1</span> Sélection de colonnes</a></li>
  <li><a href="#selection-de-lignes" id="toc-selection-de-lignes" class="nav-link" data-scroll-target="#selection-de-lignes"><span class="header-section-number">8.2</span> Selection de lignes</a></li>
  </ul></li>
  <li><a href="#manipuler-des-lignes-et-des-colonnes-1" id="toc-manipuler-des-lignes-et-des-colonnes-1" class="nav-link" data-scroll-target="#manipuler-des-lignes-et-des-colonnes-1"><span class="header-section-number">9</span> Manipuler des lignes et des colonnes</a>
  <ul class="collapse">
  <li><a href="#mettre-un-0-devant-un-nombre" id="toc-mettre-un-0-devant-un-nombre" class="nav-link" data-scroll-target="#mettre-un-0-devant-un-nombre"><span class="header-section-number">9.1</span> Mettre un 0 devant un nombre</a></li>
  <li><a href="#réexprimer-en-masse-des-valeurs" id="toc-réexprimer-en-masse-des-valeurs" class="nav-link" data-scroll-target="#réexprimer-en-masse-des-valeurs"><span class="header-section-number">9.2</span> Réexprimer en masse des valeurs</a></li>
  <li><a href="#passer-une-variable-de-numérique-à-caractère-et-vice-versa" id="toc-passer-une-variable-de-numérique-à-caractère-et-vice-versa" class="nav-link" data-scroll-target="#passer-une-variable-de-numérique-à-caractère-et-vice-versa"><span class="header-section-number">9.3</span> Passer une variable de numérique à caractère et vice-versa</a></li>
  <li><a href="#arrondir-une-valeur-numérique" id="toc-arrondir-une-valeur-numérique" class="nav-link" data-scroll-target="#arrondir-une-valeur-numérique"><span class="header-section-number">9.4</span> Arrondir une valeur numérique</a></li>
  </ul></li>
  <li><a href="#les-tris" id="toc-les-tris" class="nav-link" data-scroll-target="#les-tris"><span class="header-section-number">10</span> Les tris</a>
  <ul class="collapse">
  <li><a href="#trier-par-colonne" id="toc-trier-par-colonne" class="nav-link" data-scroll-target="#trier-par-colonne"><span class="header-section-number">10.1</span> Trier par colonne</a></li>
  <li><a href="#trier-les-lignes-par-ordre-croissant-ou-décroissant" id="toc-trier-les-lignes-par-ordre-croissant-ou-décroissant" class="nav-link" data-scroll-target="#trier-les-lignes-par-ordre-croissant-ou-décroissant"><span class="header-section-number">10.2</span> Trier les lignes par ordre croissant ou décroissant</a></li>
  <li><a href="#incidence-des-valeurs-manquantes-dans-les-tris-différence-entre-sas-et-r" id="toc-incidence-des-valeurs-manquantes-dans-les-tris-différence-entre-sas-et-r" class="nav-link" data-scroll-target="#incidence-des-valeurs-manquantes-dans-les-tris-différence-entre-sas-et-r"><span class="header-section-number">10.3</span> Incidence des valeurs manquantes dans les tris, différence entre SAS et R</a></li>
  </ul></li>
  <li><a href="#manipuler-des-dates" id="toc-manipuler-des-dates" class="nav-link" data-scroll-target="#manipuler-des-dates"><span class="header-section-number">11</span> Manipuler des dates</a>
  <ul class="collapse">
  <li><a href="#créer-une-date" id="toc-créer-une-date" class="nav-link" data-scroll-target="#créer-une-date"><span class="header-section-number">11.1</span> Créer une date</a></li>
  <li><a href="#calculer-des-durées" id="toc-calculer-des-durées" class="nav-link" data-scroll-target="#calculer-des-durées"><span class="header-section-number">11.2</span> Calculer des durées</a></li>
  <li><a href="#ajouter-une-durée-à-une-date" id="toc-ajouter-une-durée-à-une-date" class="nav-link" data-scroll-target="#ajouter-une-durée-à-une-date"><span class="header-section-number">11.3</span> Ajouter une durée à une date</a></li>
  </ul></li>
  <li><a href="#manipuler-des-chaînes-de-caractères" id="toc-manipuler-des-chaînes-de-caractères" class="nav-link" data-scroll-target="#manipuler-des-chaînes-de-caractères"><span class="header-section-number">12</span> Manipuler des chaînes de caractères</a>
  <ul class="collapse">
  <li><a href="#majuscule-minuscule" id="toc-majuscule-minuscule" class="nav-link" data-scroll-target="#majuscule-minuscule"><span class="header-section-number">12.1</span> Majuscule, minuscule</a></li>
  <li><a href="#remplacer-une-chaîne-de-catactère-par-une-autre" id="toc-remplacer-une-chaîne-de-catactère-par-une-autre" class="nav-link" data-scroll-target="#remplacer-une-chaîne-de-catactère-par-une-autre"><span class="header-section-number">12.2</span> Remplacer une chaîne de catactère par une autre</a></li>
  <li><a href="#supprimer-des-blancs" id="toc-supprimer-des-blancs" class="nav-link" data-scroll-target="#supprimer-des-blancs"><span class="header-section-number">12.3</span> Supprimer des blancs</a></li>
  <li><a href="#concaténer-des-chaînes-de-caractères" id="toc-concaténer-des-chaînes-de-caractères" class="nav-link" data-scroll-target="#concaténer-des-chaînes-de-caractères"><span class="header-section-number">12.4</span> Concaténer des chaînes de caractères</a></li>
  <li><a href="#nombre-de-caractères-dans-une-chaîne-de-caractères" id="toc-nombre-de-caractères-dans-une-chaîne-de-caractères" class="nav-link" data-scroll-target="#nombre-de-caractères-dans-une-chaîne-de-caractères"><span class="header-section-number">12.5</span> Nombre de caractères dans une chaîne de caractères</a></li>
  <li><a href="#transformer-plusieurs-caractères-différents" id="toc-transformer-plusieurs-caractères-différents" class="nav-link" data-scroll-target="#transformer-plusieurs-caractères-différents"><span class="header-section-number">12.6</span> Transformer plusieurs caractères différents</a></li>
  </ul></li>
  <li><a href="#gestion-ligne-par-ligne" id="toc-gestion-ligne-par-ligne" class="nav-link" data-scroll-target="#gestion-ligne-par-ligne"><span class="header-section-number">13</span> Gestion ligne par ligne</a>
  <ul class="collapse">
  <li><a href="#numéro-de-lobservation" id="toc-numéro-de-lobservation" class="nav-link" data-scroll-target="#numéro-de-lobservation"><span class="header-section-number">13.1</span> Numéro de l’observation</a></li>
  <li><a href="#trier-des-colonnes" id="toc-trier-des-colonnes" class="nav-link" data-scroll-target="#trier-des-colonnes"><span class="header-section-number">13.2</span> Trier des colonnes</a></li>
  <li><a href="#identifier-le-1er-le-2e-le-dernier-contrat-dun-individu" id="toc-identifier-le-1er-le-2e-le-dernier-contrat-dun-individu" class="nav-link" data-scroll-target="#identifier-le-1er-le-2e-le-dernier-contrat-dun-individu"><span class="header-section-number">13.3</span> Identifier le 1er, le 2e, le dernier contrat d’un individu</a></li>
  <li><a href="#date-de-fin-du-contrat-précédent" id="toc-date-de-fin-du-contrat-précédent" class="nav-link" data-scroll-target="#date-de-fin-du-contrat-précédent"><span class="header-section-number">13.4</span> Date de fin du contrat précédent</a></li>
  <li><a href="#valeur-retardée-lag" id="toc-valeur-retardée-lag" class="nav-link" data-scroll-target="#valeur-retardée-lag"><span class="header-section-number">13.5</span> Valeur retardée (lag)</a></li>
  <li><a href="#transposer-une-base" id="toc-transposer-une-base" class="nav-link" data-scroll-target="#transposer-une-base"><span class="header-section-number">13.6</span> Transposer une base</a></li>
  </ul></li>
  <li><a href="#les-valeurs-manquantes" id="toc-les-valeurs-manquantes" class="nav-link" data-scroll-target="#les-valeurs-manquantes"><span class="header-section-number">14</span> Les valeurs manquantes</a>
  <ul class="collapse">
  <li><a href="#repérer-les-valeurs-manquantes" id="toc-repérer-les-valeurs-manquantes" class="nav-link" data-scroll-target="#repérer-les-valeurs-manquantes"><span class="header-section-number">14.1</span> Repérer les valeurs manquantes</a></li>
  <li><a href="#incidence-des-valeurs-manquantes-différent-entre-sas-et-r" id="toc-incidence-des-valeurs-manquantes-différent-entre-sas-et-r" class="nav-link" data-scroll-target="#incidence-des-valeurs-manquantes-différent-entre-sas-et-r"><span class="header-section-number">14.2</span> Incidence des valeurs manquantes, différent entre SAS et R</a></li>
  </ul></li>
  <li><a href="#les-doublons" id="toc-les-doublons" class="nav-link" data-scroll-target="#les-doublons"><span class="header-section-number">15</span> Les doublons</a>
  <ul class="collapse">
  <li><a href="#repérage-des-doublons" id="toc-repérage-des-doublons" class="nav-link" data-scroll-target="#repérage-des-doublons"><span class="header-section-number">15.1</span> Repérage des doublons</a></li>
  <li><a href="#suppression-des-doublons" id="toc-suppression-des-doublons" class="nav-link" data-scroll-target="#suppression-des-doublons"><span class="header-section-number">15.2</span> Suppression des doublons</a></li>
  </ul></li>
  <li><a href="#les-jointures-de-base" id="toc-les-jointures-de-base" class="nav-link" data-scroll-target="#les-jointures-de-base"><span class="header-section-number">16</span> Les jointures de base</a>
  <ul class="collapse">
  <li><a href="#inner-join-identifiants-communs-aux-bases" id="toc-inner-join-identifiants-communs-aux-bases" class="nav-link" data-scroll-target="#inner-join-identifiants-communs-aux-bases"><span class="header-section-number">16.1</span> Inner Join : identifiants communs aux bases</a></li>
  <li><a href="#left-et-right-join-identifiants-de-lune-des-bases" id="toc-left-et-right-join-identifiants-de-lune-des-bases" class="nav-link" data-scroll-target="#left-et-right-join-identifiants-de-lune-des-bases"><span class="header-section-number">16.2</span> Left et Right Join : identifiants de l’une des bases</a></li>
  <li><a href="#full-join-identifiants-de-lune-ou-lautre-des-bases" id="toc-full-join-identifiants-de-lune-ou-lautre-des-bases" class="nav-link" data-scroll-target="#full-join-identifiants-de-lune-ou-lautre-des-bases"><span class="header-section-number">16.3</span> Full Join : identifiants de l’une ou l’autre des bases</a></li>
  <li><a href="#cross-join-toutes-les-combinaisons-possibles" id="toc-cross-join-toutes-les-combinaisons-possibles" class="nav-link" data-scroll-target="#cross-join-toutes-les-combinaisons-possibles"><span class="header-section-number">16.4</span> Cross Join : toutes les combinaisons possibles</a></li>
  <li><a href="#empiler-les-bases" id="toc-empiler-les-bases" class="nav-link" data-scroll-target="#empiler-les-bases"><span class="header-section-number">16.5</span> Empiler les bases</a></li>
  </ul></li>
  <li><a href="#statistiques-descriptives" id="toc-statistiques-descriptives" class="nav-link" data-scroll-target="#statistiques-descriptives"><span class="header-section-number">17</span> Statistiques descriptives</a>
  <ul class="collapse">
  <li><a href="#somme-moyenne-médiane-minimum-maximum-nombre-de-valeurs" id="toc-somme-moyenne-médiane-minimum-maximum-nombre-de-valeurs" class="nav-link" data-scroll-target="#somme-moyenne-médiane-minimum-maximum-nombre-de-valeurs"><span class="header-section-number">17.1</span> Somme, moyenne, médiane, minimum, maximum, nombre de valeurs</a></li>
  <li><a href="#quantiles" id="toc-quantiles" class="nav-link" data-scroll-target="#quantiles"><span class="header-section-number">17.2</span> Quantiles</a></li>
  <li><a href="#tableaux-de-fréquence-contingence-proc-freq" id="toc-tableaux-de-fréquence-contingence-proc-freq" class="nav-link" data-scroll-target="#tableaux-de-fréquence-contingence-proc-freq"><span class="header-section-number">17.3</span> Tableaux de fréquence / contingence : proc freq</a></li>
  <li><a href="#proportion" id="toc-proportion" class="nav-link" data-scroll-target="#proportion"><span class="header-section-number">17.4</span> Proportion</a></li>
  </ul></li>
  <li><a href="#fonction-macros-sas" id="toc-fonction-macros-sas" class="nav-link" data-scroll-target="#fonction-macros-sas"><span class="header-section-number">18</span> Fonction, macros SAS</a>
  <ul class="collapse">
  <li><a href="#boucles-itérations" id="toc-boucles-itérations" class="nav-link" data-scroll-target="#boucles-itérations"><span class="header-section-number">18.1</span> Boucles, itérations</a></li>
  <li><a href="#créations-automatiques-de-bases-empilements-de-bases" id="toc-créations-automatiques-de-bases-empilements-de-bases" class="nav-link" data-scroll-target="#créations-automatiques-de-bases-empilements-de-bases"><span class="header-section-number">18.2</span> Créations automatiques de bases, empilements de bases</a></li>
  </ul></li>
  <li><a href="#fin-du-programme" id="toc-fin-du-programme" class="nav-link" data-scroll-target="#fin-du-programme"><span class="header-section-number">19</span> Fin du programme</a>
  <ul class="collapse">
  <li><a href="#supprimer-toutes-les-bases-de-la-mémoire-vive-work-ram" id="toc-supprimer-toutes-les-bases-de-la-mémoire-vive-work-ram" class="nav-link" data-scroll-target="#supprimer-toutes-les-bases-de-la-mémoire-vive-work-ram"><span class="header-section-number">19.1</span> Supprimer toutes les bases de la mémoire vive (work RAM)</a></li>
  </ul></li>
  <li><a href="#points-de-vigilance-en-sas" id="toc-points-de-vigilance-en-sas" class="nav-link" data-scroll-target="#points-de-vigilance-en-sas"><span class="header-section-number">20</span> Points de vigilance en SAS</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Aide-mémoire SAS - <code>R</code></h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">SAS</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Un aide-mémoire pour les statisticiens qui connaissent SAS et souhaitent travailler avec <code>R</code>.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur·rice·s</div>
    <div class="quarto-title-meta-contents">
             <p>Nassab ABDALLAH<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> </p>
             <p>Damien EUZENAT<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> </p>
             <p>Sébastien LI-THIAO-TE<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Date de publication</div>
    <div class="quarto-title-meta-contents">
      <p class="date">29 janvier 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>L’aide-mémoire a pour but de fournir des codes écrits en SAS et d’en donner la traduction en R de trois manières possibles :</p>
<ul>
<li><p>en utilisant la base R</p></li>
<li><p>en utilisant dplyr</p></li>
<li><p>en utilisant data.table <em>(en cours)</em></p></li>
</ul>
<p>Les éléments utilisés sont des codes typiques qui sont appliqués dans la production statistique ou dans la réalisation d’études descriptives.</p>
<p>Ce code s’adresse aux utilisateurs de SAS qui veulent connaître la traduction du code SAS en R ainsi qu’aux utilisateurs de R qui ont besoin de comprendre le code SAS.</p>
<section id="importation-des-packages" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="importation-des-packages"><span class="header-section-number">1</span> Importation des packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SASmarkdown)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="chemin-vers-le-bureau-et-affichage-de-la-date-et-de-lannée" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="chemin-vers-le-bureau-et-affichage-de-la-date-et-de-lannée"><span class="header-section-number">2</span> Chemin vers le bureau et affichage de la date et de l’année</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>R base</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<pre><code>/* Chemin du bureau de l'utilisateur */

/* On vide la log */
dm "log; clear; ";

/* On récupère déjà l'identifiant de l'utilisateur */
%let user = &amp;sysuserid;

/* Chemin proprement dit */
%let bureau = C:\Users\&amp;user.\Desktop;
libname bur "&amp;bureau.";

/* Affichage de l'année */
%let an = %sysfunc(year(%sysfunc(today())));

/* &amp; (esperluette) indique à SAS qu'il doit remplacer an par sa valeur définie par le %let */
%put Année : &amp;an.;

/* Autre possibilité */
data _null_;call symput('annee', strip(year(today())));run;
%put Année (autre méthode) : &amp;annee.;

/* Année passée */
%put Année passée : %eval(&amp;an. - 1);</code></pre>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère déjà l'identifiant de l'utilisateur</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>user <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"USERNAME"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Chemin d'accès au bureau de l'utilisateur</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>chemin <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"C:/Users"</span>, user, <span class="st">"Desktop"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage de l'année</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>annee <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Année : %04d"</span>, annee)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Année : "</span>, annee))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>annee_1 <span class="ot">&lt;-</span> annee <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Année passée: "</span>, annee_1)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (annee <span class="sc">&gt;=</span> <span class="dv">2023</span>) {</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Nous sommes en 2023 ou après"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Nous sommes en 2022 ou avant"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="création-dune-base-de-données" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="création-dune-base-de-données"><span class="header-section-number">3</span> Création d’une base de données</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<pre><code>/* Données fictives sur des formations */
data Donnees;
infile cards dsd dlm='|';
format Identifiant $3. Sexe_red 1. CSP $1. Niveau $30. Date_naissance ddmmyy10. Date_entree ddmmyy10. Duree Note_Contenu Note_Formateur Note_Moyens
Note_Accompagnement Note_Materiel poids_sondage;
input Identifiant $ Sexe_red CSP $ Niveau $ Date_naissance :ddmmyy10. Date_entree :ddmmyy10. Duree Note_Contenu Note_Formateur Note_Moyens
Note_Accompagnement Note_Materiel poids_sondage;
cards;
173|2|1|Qualifie|17/06/1998|01/01/2021|308|12|6|17|4|19|117.1
173|2|1|qualifie|17/06/1998|01/01/2022|365|6||12|7|14|98.3
173|2|1|qualifie|17/06/1998|06/01/2022|185|8|10|11|1|9|214.6
173|2|1|Qualifie|17/06/1998|02/01/2023|365|14|15|15|10|8|84.7
174|1|1|qualifie|08/12/1984|17/08/2021|183|17|18|20|15|12|65.9
175|1|1|qualifie|16/09/1989|21/12/2022|730|5|5|8|4|9|148.2
198|2|4|Non qualifie|17/03/1987|28/07/2022|30|10|10|10|16|8|89.6
198|2|4|Qualifie|17/03/1987|17/11/2022|164|11|7|6|14|13|100.3
198|2|4|Qualifie|17/03/1987|21/02/2023|365|9|20|3|4|17|49.3
168|1|2|Qualifie|30/07/2002|04/09/2019|365|18|11|20|13|15|148.2
211|2|3|Non qualifie||17/12/2021|135|16|16|15|12|9|86.4
278|1|5|Qualifie|10/08/1948|07/06/2018|365|14|10|6|8|12|99.2
347|2|5|Qualifie|13/09/1955||180|12|5|7|11|12|105.6
112|1|3|Non qualifie|13/09/2001|02/03/2022|212|3|10|11|9|8|123.1
112|1|3|Non qualifie|13/09/2001|01/03/2021|365|7|13|8|19|2|137.4
112|1|3|Non qualifie|13/09/2001|01/12/2023|365||||||187.6
087|1|3|Non qualifie|||365||||||87.3
087|1|3|Non qualifie||31/10/2020|365||||||87.3
099|1|3|qualifie|06/06/1998|01/03/2021|364|12|11|10|12|13|169.3
099|1|3|qualifie|06/06/1998|01/03/2022|364|12|11|10|12|13|169.3
099|1|3|qualifie|06/06/1998|01/03/2023|364|12|11|10|12|13|169.3
187|2|2|qualifie|05/12/1986|01/01/2022|364|10|10|10|10|10|169.3
187|2|2|qualifie|05/12/1986|01/01/2023|364|10|10|10|10|10|234.1
689|1|1||01/12/2000|06/11/2017|123|9|7|8|13|16|189.3
765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9
765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9
765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9
;
run;</code></pre>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la base R</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="st">"Identifiant|Sexe_red|CSP|Niveau|Date_naissance|Date_entree|Duree|Note_Contenu|Note_Formateur|Note_Moyens|Note_Accompagnement|Note_Materiel|poids_sondage</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">173|2|1|Qualifie|17/06/1998|01/01/2021|308|12|6|17|4|19|117.1</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">173|2|1|qualifie|17/06/1998|01/01/2022|365|6||12|7|14|98.3</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">173|2|1|qualifie|17/06/1998|06/01/2022|185|8|10|11|1|9|214.6</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">173|2|1|Qualifie|17/06/1998|02/01/2023|365|14|15|15|10|8|84.7</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">174|1|1|qualifie|08/12/1984|17/08/2021|183|17|18|20|15|12|65.9</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">175|1|1|qualifie|16/09/1989|21/12/2022|730|5|5|8|4|9|148.2</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">198|2|4|Non qualifie|17/03/1987|28/07/2022|30|10|10|10|16|8|89.6</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">198|2|4|Qualifie|17/03/1987|17/11/2022|164|11|7|6|14|13|100.3</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">198|2|4|Qualifie|17/03/1987|21/02/2023|365|9|20|3|4|17|49.3</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">168|1|2|Qualifie|30/07/2002|04/09/2019|365|18|11|20|13|15|148.2</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">211|2|3|Non qualifie||17/12/2021|135|16|16|15|12|9|86.4</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="st">278|1|5|Qualifie|10/08/1948|07/06/2018|365|14|10|6|8|12|99.2</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="st">347|2|5|Qualifie|13/09/1955||180|12|5|7|11|12|105.6</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="st">112|1|3|Non qualifie|13/09/2001|02/03/2022|212|3|10|11|9|8|123.1</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="st">112|1|3|Non qualifie|13/09/2001|01/03/2021|365|7|13|8|19|2|137.4</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="st">112|1|3|Non qualifie|13/09/2001|01/12/2023|365||||||187.6</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="st">087|1|3|Non qualifie|||365||||||87.3</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="st">087|1|3|Non qualifie||31/10/2020|365||||||87.3</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="st">099|1|3|qualifie|06/06/1998|01/03/2021|364|12|11|10|12|13|169.3</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="st">099|1|3|qualifie|06/06/1998|01/03/2022|364|12|11|10|12|13|169.3</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="st">099|1|3|qualifie|06/06/1998|01/03/2023|364|12|11|10|12|13|169.3</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="st">187|2|2|qualifie|05/12/1986|01/01/2022|364|10|10|10|10|10|169.3</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="st">187|2|2|qualifie|05/12/1986|01/01/2023|364|10|10|10|10|10|234.1</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="st">689|1|1||01/12/2000|06/11/2017|123|9|7|8|13|16|189.3</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="st">765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="st">765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="st">765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fichier <span class="ot">&lt;-</span> <span class="fu">file.path</span>(chemin, <span class="st">"Passage SAS à R.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On copie ce fichier texte sur le bureau de l'utilisateur</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(a, <span class="at">con =</span> fichier)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in file(con, "w"): cannot open the connection</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va importer ce fichier texte en base R (dataframe)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On importe la base de données dans R</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># on importe par défaut les colonnes en texte</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(chemin, <span class="st">"Passage SAS à R.csv"</span>), <span class="at">sep =</span> <span class="st">"|"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">na.strings =</span> <span class="st">""</span>,<span class="at">colClasses =</span> <span class="fu">rep</span>(<span class="st">"character"</span>,<span class="fu">length</span>(data)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in file(file, "rt"): cannot open the connection</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la base R</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="st">"Identifiant|Sexe_red|CSP|Niveau|Date_naissance|Date_entree|Duree|Note_Contenu|Note_Formateur|Note_Moyens|Note_Accompagnement|Note_Materiel|poids_sondage</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">173|2|1|Qualifie|17/06/1998|01/01/2021|308|12|6|17|4|19|117.1</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">173|2|1|qualifie|17/06/1998|01/01/2022|365|6||12|7|14|98.3</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">173|2|1|qualifie|17/06/1998|06/01/2022|185|8|10|11|1|9|214.6</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">173|2|1|Qualifie|17/06/1998|02/01/2023|365|14|15|15|10|8|84.7</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">174|1|1|qualifie|08/12/1984|17/08/2021|183|17|18|20|15|12|65.9</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">175|1|1|qualifie|16/09/1989|21/12/2022|730|5|5|8|4|9|148.2</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">198|2|4|Non qualifie|17/03/1987|28/07/2022|30|10|10|10|16|8|89.6</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">198|2|4|Qualifie|17/03/1987|17/11/2022|164|11|7|6|14|13|100.3</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="st">198|2|4|Qualifie|17/03/1987|21/02/2023|365|9|20|3|4|17|49.3</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="st">168|1|2|Qualifie|30/07/2002|04/09/2019|365|18|11|20|13|15|148.2</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="st">211|2|3|Non qualifie||17/12/2021|135|16|16|15|12|9|86.4</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="st">278|1|5|Qualifie|10/08/1948|07/06/2018|365|14|10|6|8|12|99.2</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="st">347|2|5|Qualifie|13/09/1955||180|12|5|7|11|12|105.6</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="st">112|1|3|Non qualifie|13/09/2001|02/03/2022|212|3|10|11|9|8|123.1</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="st">112|1|3|Non qualifie|13/09/2001|01/03/2021|365|7|13|8|19|2|137.4</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="st">112|1|3|Non qualifie|13/09/2001|01/12/2023|365||||||187.6</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="st">087|1|3|Non qualifie|||365||||||87.3</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="st">087|1|3|Non qualifie||31/10/2020|365||||||87.3</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="st">099|1|3|qualifie|06/06/1998|01/03/2021|364|12|11|10|12|13|169.3</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="st">099|1|3|qualifie|06/06/1998|01/03/2022|364|12|11|10|12|13|169.3</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="st">099|1|3|qualifie|06/06/1998|01/03/2023|364|12|11|10|12|13|169.3</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="st">187|2|2|qualifie|05/12/1986|01/01/2022|364|10|10|10|10|10|169.3</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="st">187|2|2|qualifie|05/12/1986|01/01/2023|364|10|10|10|10|10|234.1</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="st">689|1|1||01/12/2000|06/11/2017|123|9|7|8|13|16|189.3</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="st">765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="st">765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="st">765|1|4|Non qualifie|26/12/1995|17/04/2020|160|13|10|12|18|10|45.9"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#readLines va permettre de créer un objet pour chaque ligne</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#strsplit va permettre de séparer les textes qui sont entre des "|" </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span>  <span class="fu">readLines</span>(<span class="fu">textConnection</span>(a)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="at">split=</span><span class="st">'|'</span>,<span class="at">fixed=</span><span class="cn">TRUE</span>) </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(a), <span class="at">nrow=</span><span class="fu">length</span>(a), <span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#La première ligne donne le nom des colonnes</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">row_to_names</span>(<span class="at">row_number =</span> <span class="dv">1</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#On remplace les valeurs qui sont des espaces par des "NA" dans toute </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#la base de données </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(na_if,<span class="st">""</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Duckdb fonctionne comme un serveur SQL. Il faut transférer les données vers le serveur SQL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ouvrir une connexion au serveur duckdb</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>()); </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On "copie" les données dans une table du nom table_duckdb</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>con <span class="sc">%&gt;%</span> duckdb<span class="sc">::</span><span class="fu">duckdb_register</span>(<span class="at">name =</span> <span class="st">"table_duckdb"</span>, <span class="at">df =</span> donnees_tidyverse)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>con <span class="sc">%&gt;%</span> <span class="fu">tbl</span>(<span class="st">"table_duckdb"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;table_duckdb&gt; [?? x 13]
# Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1018-azure:R 4.2.0/:memory:]
   Identifiant Sexe_red CSP   Niveau       Date_naissance Date_entree Duree
   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;
 1 173         2        1     Qualifie     17/06/1998     01/01/2021  308  
 2 173         2        1     qualifie     17/06/1998     01/01/2022  365  
 3 173         2        1     qualifie     17/06/1998     06/01/2022  185  
 4 173         2        1     Qualifie     17/06/1998     02/01/2023  365  
 5 174         1        1     qualifie     08/12/1984     17/08/2021  183  
 6 175         1        1     qualifie     16/09/1989     21/12/2022  730  
 7 198         2        4     Non qualifie 17/03/1987     28/07/2022  30   
 8 198         2        4     Qualifie     17/03/1987     17/11/2022  164  
 9 198         2        4     Qualifie     17/03/1987     21/02/2023  365  
10 168         1        2     Qualifie     30/07/2002     04/09/2019  365  
# ℹ more rows
# ℹ 6 more variables: Note_Contenu &lt;chr&gt;, Note_Formateur &lt;chr&gt;,
#   Note_Moyens &lt;chr&gt;, Note_Accompagnement &lt;chr&gt;, Note_Materiel &lt;chr&gt;,
#   poids_sondage &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fermer la connexion au serveur duckdb</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour la suite, on suppose que la connexion est ouverte sous le nom <code>con</code>, et que les données sont accessibles par la requête <code>requete_duckdb</code>. Le code modifiera la requete, mais pas la table dans le serveur SQL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>()); </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>con <span class="sc">%&gt;%</span> duckdb<span class="sc">::</span><span class="fu">duckdb_register</span>(<span class="at">name =</span> <span class="st">"table_duckdb"</span>, <span class="at">df =</span> donnees_tidyverse)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> con <span class="sc">%&gt;%</span> <span class="fu">tbl</span>(<span class="st">"table_duckdb"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>N.B. Duckdb est envisagé pour des traitements sans charger des données en mémoire, par exemple en lisant directement un fichier <code>.parquet</code> sur le disque dur. Dans ce cas, les opérations sont effectuées à la volée, mais n’affectent pas les fichiers source.</p>
</div>
</div>
</div>
</section>
<section id="manipuler-les-colonnes-de-la-base-de-données" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="manipuler-les-colonnes-de-la-base-de-données"><span class="header-section-number">4</span> Manipuler les colonnes de la base de données</h2>
<p><span style="color:red"><strong>R étant sensible à la casse, ce qui n’est pas le cas de SAS, cette section est donc pertinente pour les codes sous R.</strong></span></p>
<ol type="1">
<li>Extraire les noms des variables de la base</li>
<li>Mettre le nom de la colonne en minuscules</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R est sensible à la casse, il est pertinent d'harmoniser les noms des variables en minuscule</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>nomCol <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(donnees_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in is.data.frame(x): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(donnees_rbase) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(donnees_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in is.data.frame(x): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">set_colnames</span>(<span class="at">value =</span> <span class="fu">casefold</span>(<span class="fu">colnames</span>(.), <span class="at">upper =</span> <span class="cn">FALSE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Identifiant"         "Sexe_red"            "CSP"                
 [4] "Niveau"              "Date_naissance"      "Date_entree"        
 [7] "Duree"               "Note_Contenu"        "Note_Formateur"     
[10] "Note_Moyens"         "Note_Accompagnement" "Note_Materiel"      
[13] "poids_sondage"      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(tolower) </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "identifiant"         "sexe_red"            "csp"                
 [4] "niveau"              "date_naissance"      "date_entree"        
 [7] "duree"               "note_contenu"        "note_formateur"     
[10] "note_moyens"         "note_accompagnement" "note_materiel"      
[13] "poids_sondage"      </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="harmoniser-le-format-des-variables" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="harmoniser-le-format-des-variables"><span class="header-section-number">5</span> Harmoniser le format des variables</h2>
<p>Convertir certaines variables en format ‘date’, ‘integer’ et ‘numeric’</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<pre><code>  data Donnees_sas;
  set Donnees_sas;
  duree_int = input(duree, 1.);
  note_contenu_int = input(note_contenu, 1.);
  note_formateur_int = input(note_formateur, 1.);
  note_moyens_int = input(note_moyens, 1.);
  note_accompagnement_int = input(note_accompagnement, 1.);
  note_materiel_int = input(note_materiel, 1.);
  date_naissance_date = input(date_naissance, DDMMYY10.);
  date_entree = input(date_entree, DDMMYY10.);
run;</code></pre>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>enNumerique <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"duree"</span>, <span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>enDate <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'date_naissance'</span>, <span class="st">'date_entree'</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, enNumerique] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(donnees_rbase[, enNumerique], as.integer)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lapply(donnees_rbase[, enNumerique], as.integer): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, enDate] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(donnees_rbase[, enDate], lubridate<span class="sc">::</span>dmy)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lapply(donnees_rbase[, enDate], lubridate::dmy): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>poids_sondage <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(donnees_rbase<span class="sc">$</span>poids_sondage)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>enNumerique <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"duree"</span>, <span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>enDate <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'date_naissance'</span>, <span class="st">'date_entree'</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enNumerique, as.integer) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poids_sondage=</span><span class="fu">as.numeric</span>(poids_sondage)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enDate, lubridate<span class="sc">::</span>dmy)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>enNumerique <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"duree"</span>, <span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>enDate <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'date_naissance'</span>, <span class="st">'date_entree'</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span>  </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enNumerique, as.integer) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poids_sondage=</span><span class="fu">as.numeric</span>(poids_sondage)) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enDate, <span class="sc">~</span> <span class="fu">as.Date</span>(<span class="fu">strptime</span>(.,<span class="st">'%d/%m/%Y'</span>))) <span class="co"># strptime est une fonction duckdb</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">select</span>(enDate, duree, note_contenu)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 4]
# Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1018-azure:R 4.2.0/:memory:]
   date_naissance date_entree duree note_contenu
   &lt;date&gt;         &lt;date&gt;      &lt;int&gt;        &lt;int&gt;
 1 1998-06-17     2021-01-01    308           12
 2 1998-06-17     2022-01-01    365            6
 3 1998-06-17     2022-01-06    185            8
 4 1998-06-17     2023-01-02    365           14
 5 1984-12-08     2021-08-17    183           17
 6 1989-09-16     2022-12-21    730            5
 7 1987-03-17     2022-07-28     30           10
 8 1987-03-17     2022-11-17    164           11
 9 1987-03-17     2023-02-21    365            9
10 2002-07-30     2019-09-04    365           18
# ℹ more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="information-sur-la-base-de-données" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="information-sur-la-base-de-données"><span class="header-section-number">6</span> Information sur la base de données</h2>
<section id="extraire-les-10-première-lignes-de-la-base" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="extraire-les-10-première-lignes-de-la-base"><span class="header-section-number">6.1</span> Extraire les 10 première lignes de la base</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<pre><code>/* Extraire les x premières lignes de la base (10 par défaut) */

%let x = 10;
proc print data = Donnees_sas (firstobs = 1 obs = &amp;x.);run;

/* Ou alors */
data Lignes&amp;x.;set Donnees_sas (firstobs = 1 obs = &amp;x.);proc print;run;</code></pre>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les 10 premières lignes de la base</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(donnees_rbase): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(donnees_rbase[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in as.data.frame(x): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in head(donnees_rbase): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>En duckdb, les dix premières lignes sont affichées par défaut. Si on veut les récupérer, par exemple dans une autre variable, il faut faire <code>collect()</code>. Attention, comme il n’y a pas d’ordre en SQL, il faut ordonner les lignes si on veut un résultat reproductible. C’est une opération qui peut être couteuse en temps CPU.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">collect</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 13
   identifiant sexe_red csp   niveau       date_naissance date_entree duree
   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;        &lt;date&gt;         &lt;date&gt;      &lt;int&gt;
 1 173         2        1     Qualifie     1998-06-17     2021-01-01    308
 2 173         2        1     qualifie     1998-06-17     2022-01-01    365
 3 173         2        1     qualifie     1998-06-17     2022-01-06    185
 4 173         2        1     Qualifie     1998-06-17     2023-01-02    365
 5 174         1        1     qualifie     1984-12-08     2021-08-17    183
 6 175         1        1     qualifie     1989-09-16     2022-12-21    730
 7 198         2        4     Non qualifie 1987-03-17     2022-07-28     30
 8 198         2        4     Qualifie     1987-03-17     2022-11-17    164
 9 198         2        4     Qualifie     1987-03-17     2023-02-21    365
10 168         1        2     Qualifie     2002-07-30     2019-09-04    365
# ℹ 6 more variables: note_contenu &lt;int&gt;, note_formateur &lt;int&gt;,
#   note_moyens &lt;int&gt;, note_accompagnement &lt;int&gt;, note_materiel &lt;int&gt;,
#   poids_sondage &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="renommer-les-variables" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="renommer-les-variables"><span class="header-section-number">6.2</span> Renommer les variables</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<pre><code>/* On renomme la variable sexe_red en sexe */
  
  data Donnees_sas;
  set Donnees_sas (rename = (sexe_red = sexe));
  run;</code></pre>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la variable sexe_red en sexe</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>sexe <span class="ot">&lt;-</span> donnees_rbase<span class="sc">$</span>sexe_red</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Attention, lorsqu'on utilise ce code pour renommer la variable, l'ancienne variable reste dans la base de données </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(donnees_rbase) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sexe_red"</span>))]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la variable sexe_red en sexe</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># La fonction rename() va écraser l'ancien nom de la variable contrairement au code utilisé dans la section R base</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sexe=</span>sexe_red)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la variable sexe_red en sexe</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># La fonction rename() va écraser l'ancien nom de la variable contrairement au code utilisé dans la section R base</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sexe=</span>sexe_red)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="nombre-de-lignes-et-de-colonnes-dans-la-base" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="nombre-de-lignes-et-de-colonnes-dans-la-base"><span class="header-section-number">6.3</span> Nombre de lignes et de colonnes dans la base</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<pre><code>/* Nombre de lignes */
  
  proc sql;select count(*) as Nb_Lignes from Donnees_sas;quit;

/* Nombre de colonnes */

  proc sql;select count(*) as Nb_Colonnes from Var;quit;</code></pre>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de lignes et de colonnes dans la base</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Nombre de lignes : %d | Nombre de colonnes : %d"</span>, <span class="fu">dim</span>(donnees_rbase)[<span class="dv">1</span>], <span class="fu">dim</span>(donnees_rbase)[<span class="dv">2</span>])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in sprintf("Nombre de lignes : %d | Nombre de colonnes : %d", dim(donnees_rbase)[1], : object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de lignes</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de colonnes</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span>  <span class="fu">ncol</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<p>Duckdb/SQL ne connaît pas le nombre de lignes sans un calcul. Il faut faire <code>count()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de lignes</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="co"># retourne NA</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="co"># retourne 27</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [1 x 1]
# Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1018-azure:R 4.2.0/:memory:]
      n
  &lt;dbl&gt;
1    27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de colonnes</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span>  <span class="fu">ncol</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="afficher-les-noms-des-variables-de-la-base" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="afficher-les-noms-des-variables-de-la-base"><span class="header-section-number">6.4</span> Afficher les noms des variables de la base</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<pre><code>  proc contents data=donnees_sas; run;</code></pre>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in as.environment(pos): no item called "donnees_rbase" on the search list</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "identifiant"         "sexe"                "csp"                
 [4] "niveau"              "date_naissance"      "date_entree"        
 [7] "duree"               "note_contenu"        "note_formateur"     
[10] "note_moyens"         "note_accompagnement" "note_materiel"      
[13] "poids_sondage"      </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="création-de-colonnes-et-de-lignes" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="création-de-colonnes-et-de-lignes"><span class="header-section-number">6.5</span> Création de colonnes et de lignes</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<pre><code>data Donnees_sas;
  set Donnees_sas;
  note2 = note_contenu / 20 * 5;
  Age = intck('year', date_naissance, date_entree);
  run;</code></pre>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la colonne note2</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note2 <span class="ot">&lt;-</span> donnees_rbase<span class="sc">$</span>note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la colonne age </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">floor</span>(lubridate<span class="sc">::</span><span class="fu">time_length</span>(<span class="fu">difftime</span>(donnees_rbase<span class="sc">$</span>date_entree, donnees_rbase<span class="sc">$</span>date_naissance), <span class="st">"years"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'time_length': object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la colonne note2</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note2=</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la colonne age </span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">age=</span><span class="fu">as.period</span>(<span class="fu">interval</span>(<span class="at">start =</span> date_naissance, <span class="at">end =</span> date_entree))<span class="sc">$</span>year)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la colonne note2</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note2=</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la colonne age </span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">age=</span> <span class="fu">year</span>(<span class="fu">age</span>(date_entree,date_naissance))) </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">select</span>(note2, age)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 2]
# Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1018-azure:R 4.2.0/:memory:]
   note2   age
   &lt;dbl&gt; &lt;dbl&gt;
 1  3       22
 2  1.5     23
 3  2       23
 4  3.5     24
 5  4.25    36
 6  1.25    33
 7  2.5     35
 8  2.75    35
 9  2.25    35
10  4.5     17
# ℹ more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="supression-de-colonnes-et-de-lignes" class="level3" data-number="6.6">
<h3 data-number="6.6" class="anchored" data-anchor-id="supression-de-colonnes-et-de-lignes"><span class="header-section-number">6.6</span> Supression de colonnes et de lignes</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<pre><code>data Donnees_sas;
  set Donnees_sas;
  drop note2;
  run;</code></pre>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in donnees_rbase$note2 &lt;- NULL: object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>note2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>note2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="formater-les-modalités-des-valeurs" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="formater-les-modalités-des-valeurs"><span class="header-section-number">7</span> Formater les modalités des valeurs</h2>
<section id="valeur-discrète" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="valeur-discrète"><span class="header-section-number">7.1</span> Valeur discrète</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<pre><code>proc format;
  value sexef
  1 = "Homme"
  2 = "Femme";

  value $ cspf
  '1' = "Cadre"
  '2' = "Profession intermédiaire"
  '3' = "Employé"
  '4' = "Ouvrier"
  '5' = "Retraité";
run;</code></pre>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>sexef <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Homme"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Femme"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>cspf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Cadre"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Profession intermédiaire"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Employé"</span>, <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Ouvrier"</span>, <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Retraité"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On exprime CSP et sexe en formaté</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>cspf <span class="ot">&lt;-</span> cspf[donnees_rbase<span class="sc">$</span>csp]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>sexef <span class="ot">&lt;-</span> sexef[donnees_rbase<span class="sc">$</span>sexe]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexef =</span> <span class="fu">case_when</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    sexe<span class="sc">==</span><span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Homme"</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    sexe<span class="sc">==</span><span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Femme"</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> sexe),</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cspf =</span> <span class="fu">case_when</span>(</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    csp<span class="sc">==</span><span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Cadre"</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    csp<span class="sc">==</span><span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Profession intermédiaire"</span>,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>    csp<span class="sc">==</span><span class="st">"3"</span> <span class="sc">~</span> <span class="st">"Employé"</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    csp<span class="sc">==</span><span class="st">"4"</span> <span class="sc">~</span> <span class="st">"Ouvrier"</span>,</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    csp<span class="sc">==</span><span class="st">"5"</span> <span class="sc">~</span> <span class="st">"Retraité"</span>,</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> csp))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<p>Préférer <code>case_match</code> quand il s’agit de valeurs déterminées.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexef =</span> <span class="fu">case_when</span>(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    sexe<span class="sc">==</span><span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Homme"</span>,</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    sexe<span class="sc">==</span><span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Femme"</span>,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> sexe),</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cspf =</span> <span class="fu">case_match</span>(csp,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Cadre"</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Profession intermédiaire"</span>,</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="sc">~</span> <span class="st">"Employé"</span>,</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="sc">~</span> <span class="st">"Ouvrier"</span>,</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5"</span> <span class="sc">~</span> <span class="st">"Retraité"</span>,</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> csp))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="valeur-continue" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="valeur-continue"><span class="header-section-number">7.2</span> Valeur continue</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<pre><code>proc format;
  value agef
  low-&lt;26 = "1. De 15 à 25 ans"
  26&lt;-&lt;50 = "2. De 26 à 49 ans"
  50-high = "3. 50 ans ou plus";
run;</code></pre>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>agef[donnees_rbase<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">26</span>]                     <span class="ot">&lt;-</span> <span class="st">"1. De 15 à 25 ans"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in donnees_rbase$agef[donnees_rbase$age &lt; 26] &lt;- "1. De 15 à 25 ans": object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 &lt;= donnees_rbase$age &lt; 50 ne fonctionne pas, il faut passer en 2 étapes</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>agef[<span class="dv">26</span> <span class="sc">&lt;=</span> donnees_rbase<span class="sc">$</span>age <span class="sc">&amp;</span> donnees_rbase<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">50</span>] <span class="ot">&lt;-</span> <span class="st">"2. De 26 à 49 ans"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in donnees_rbase$agef[26 &lt;= donnees_rbase$age &amp; donnees_rbase$age &lt; : object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>agef[donnees_rbase<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">50</span>]                    <span class="ot">&lt;-</span> <span class="st">"3. 50 ans ou plus"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in donnees_rbase$agef[donnees_rbase$age &gt;= 50] &lt;- "3. 50 ans ou plus": object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>agef <span class="ot">&lt;-</span> <span class="fu">cut</span>(donnees_rbase<span class="sc">$</span>age, </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">49</span>, <span class="cn">Inf</span>),</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">right =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1. De 15 à 25 ans"</span>, <span class="st">"2. De 26 à 49 ans"</span>, <span class="st">"3. 50 ans ou plus"</span>), </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">ordered_result =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in cut(donnees_rbase$age, breaks = c(0, 25, 49, Inf), right = TRUE, : object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agef =</span> <span class="fu">case_when</span>(</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">~</span> <span class="st">"1. De 15 à 25 ans"</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">|</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span>  <span class="st">"2. De 26 à 49 ans"</span>,</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"3. 50 ans ou plus"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agef =</span> <span class="fu">case_when</span>(</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">~</span> <span class="st">"1. De 15 à 25 ans"</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">|</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span>  <span class="st">"2. De 26 à 49 ans"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"3. 50 ans ou plus"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="manipuler-des-lignes-et-des-colonnes" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="manipuler-des-lignes-et-des-colonnes"><span class="header-section-number">8</span> Manipuler des lignes et des colonnes</h2>
<p><em>A rajouter : la selection basée sur des conditions</em></p>
<section id="sélection-de-colonnes" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="sélection-de-colonnes"><span class="header-section-number">8.1</span> Sélection de colonnes</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<pre><code>proc sql;
  create table work.donnees_col_select_sas as
  select    identifiant, csp, niveau
  from work.donnees_sas;
quit; </code></pre>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>donnees_col_select_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"csp"</span>, <span class="st">"niveau"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>donnees_col_select_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identifiant, csp, niveau)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">select</span>(identifiant, csp, niveau)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 3]
# Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1018-azure:R 4.2.0/:memory:]
   identifiant csp   niveau      
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       
 1 173         1     Qualifie    
 2 173         1     qualifie    
 3 173         1     qualifie    
 4 173         1     Qualifie    
 5 174         1     qualifie    
 6 175         1     qualifie    
 7 198         4     Non qualifie
 8 198         4     Qualifie    
 9 198         4     Qualifie    
10 168         2     Qualifie    
# ℹ more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="selection-de-lignes" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="selection-de-lignes"><span class="header-section-number">8.2</span> Selection de lignes</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<pre><code>  data donnees_sas; 
  set donnees_sas; 
  where sexef="Femme";
  run;
  </code></pre>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>donnees_femme_rbase <span class="ot">&lt;-</span> donnees_rbase[donnees_rbase<span class="sc">$</span>sexef<span class="sc">==</span><span class="st">"Femme"</span>, ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>donnees_femme_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sexef<span class="sc">==</span><span class="st">"Femme"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sexef<span class="sc">==</span><span class="st">"Femme"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 17]
# Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1018-azure:R 4.2.0/:memory:]
   identifiant sexe  csp   niveau  date_naissance date_entree duree note_contenu
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;date&gt;         &lt;date&gt;      &lt;int&gt;        &lt;int&gt;
 1 173         2     1     Qualif… 1998-06-17     2021-01-01    308           12
 2 173         2     1     qualif… 1998-06-17     2022-01-01    365            6
 3 173         2     1     qualif… 1998-06-17     2022-01-06    185            8
 4 173         2     1     Qualif… 1998-06-17     2023-01-02    365           14
 5 198         2     4     Non qu… 1987-03-17     2022-07-28     30           10
 6 198         2     4     Qualif… 1987-03-17     2022-11-17    164           11
 7 198         2     4     Qualif… 1987-03-17     2023-02-21    365            9
 8 211         2     3     Non qu… NA             2021-12-17    135           16
 9 347         2     5     Qualif… 1955-09-13     NA            180           12
10 187         2     2     qualif… 1986-12-05     2022-01-01    364           10
# ℹ more rows
# ℹ 9 more variables: note_formateur &lt;int&gt;, note_moyens &lt;int&gt;,
#   note_accompagnement &lt;int&gt;, note_materiel &lt;int&gt;, poids_sondage &lt;dbl&gt;,
#   age &lt;dbl&gt;, sexef &lt;chr&gt;, cspf &lt;chr&gt;, agef &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="manipuler-des-lignes-et-des-colonnes-1" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="manipuler-des-lignes-et-des-colonnes-1"><span class="header-section-number">9</span> Manipuler des lignes et des colonnes</h2>
<section id="mettre-un-0-devant-un-nombre" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="mettre-un-0-devant-un-nombre"><span class="header-section-number">9.1</span> Mettre un 0 devant un nombre</h3>
<ol type="1">
<li>Créer la variable <strong>mois</strong></li>
<li>Mettre un 0 devant si le mois est inférieur à 9</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<pre><code>/* Mettre un 0 devant un nombre */
  
  data Zero_devant;set Donnees_sas (keep = date_entree);
  /* Obtenir le mois et la date */
   Mois = month(date_entree);
  /* Mettre le mois sur 2 positions (avec un 0 devant si le mois &lt;= 9) : format prédéfini z2. */
  Mois_a = put(Mois, z2.);
  drop Mois;
  rename Mois_a = Mois;
  run;</code></pre>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir le mois et la date</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>mois <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">month</span>(donnees_rbase<span class="sc">$</span>date_entree)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lubridate::month(donnees_rbase$date_entree): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre le numéro du mois sur 2 positions (avec un 0 devant si le mois &lt;= 9)</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>mois <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, donnees_rbase<span class="sc">$</span>mois)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in sprintf("%02d", donnees_rbase$mois): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mois=</span>lubridate<span class="sc">::</span><span class="fu">month</span>(date_entree),</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mois=</span><span class="fu">ifelse</span>(<span class="fu">str_length</span>(mois)<span class="sc">&lt;</span><span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">"0"</span>, mois), mois))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mois=</span>lubridate<span class="sc">::</span><span class="fu">month</span>(date_entree),</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mois=</span><span class="fu">ifelse</span>(<span class="fu">str_length</span>(mois)<span class="sc">&lt;</span><span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">"0"</span>, mois), mois)) </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">select</span>(mois)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 1]
# Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1018-azure:R 4.2.0/:memory:]
   mois 
   &lt;chr&gt;
 1 01   
 2 01   
 3 01   
 4 01   
 5 08   
 6 12   
 7 07   
 8 11   
 9 02   
10 09   
# ℹ more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="réexprimer-en-masse-des-valeurs" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="réexprimer-en-masse-des-valeurs"><span class="header-section-number">9.2</span> Réexprimer en masse des valeurs</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<pre><code>/* On souhaite rééxprimer toutes les notes sur 100 et non sur 20 */
  
   %let notes = Note_Contenu   Note_Formateur Note_Moyens     Note_Accompagnement     Note_Materiel;
/* On supprime les doubles blancs entre les variables */
   %let notes = %sysfunc(compbl(&amp;notes.));
%put &amp;notes;
  
/* 1ère solution : avec les array */
  
  data Sur100_1;
  set Donnees_sas;
  array variables (*) &amp;notes.;
  do increment = 1 to dim(variables);
    variables[increment] = variables[increment] / 20 * 100;
  end; 
  drop increment;
run; 
  
  
/* 2e solution : avec une macro */

  data Sur100_2;
  set Donnees;
  %macro Sur100;
    %do i = 1 %to %sysfunc(countw(&amp;notes.));
      %let note = %scan(&amp;notes., &amp;i.);
      &amp;note. = &amp;note. / 20 * 100;
    %end;
  %mend Sur100;
  %Sur5;
run; 
  
  
/* 3e solution : l'équivalent des list-comprehension de Python en SAS */


  data Sur100_3;
  set Donnees_sas;
  %macro List_comprehension;
    %do i = 1 %to %sysfunc(countw(&amp;notes.));
      %let j = %scan(&amp;notes., &amp;i.);
        &amp;j. = &amp;j. / 20 * 100
    %end;);;
  %mend List_comprehension;
  %List_comprehension;
run;</code></pre>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite rééxprimer les notes sur 100 et non sur 20</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, notes] <span class="ot">&lt;-</span> donnees_rbase[, notes] <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(notes, <span class="sc">~</span> .x<span class="sc">/</span><span class="dv">20</span><span class="sc">*</span><span class="dv">100</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(notes, <span class="sc">~</span> .x<span class="sc">/</span><span class="dv">20</span><span class="sc">*</span><span class="dv">100</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="passer-une-variable-de-numérique-à-caractère-et-vice-versa" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="passer-une-variable-de-numérique-à-caractère-et-vice-versa"><span class="header-section-number">9.3</span> Passer une variable de numérique à caractère et vice-versa</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">

</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">

</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">

</div>
</div>
</div>
</section>
<section id="arrondir-une-valeur-numérique" class="level3" data-number="9.4">
<h3 data-number="9.4" class="anchored" data-anchor-id="arrondir-une-valeur-numérique"><span class="header-section-number">9.4</span> Arrondir une valeur numérique</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">R</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<pre><code>/* Arrondir une valeur numérique */
 data Arrondis;set Donnees_sas (keep = Poids);
/* Arrondi à l'entier le plus proche */
 poids_arrondi_0 = round(poids, 0.0);
/* Arrondi à 1 chiffre après la virgule */
 poids_arrondi_1 = round(poids, 0.1);
/* Arrondi à 2 chiffre après la virgule */
 poids_arrondi_2 = round(poids, 0.2);
/* Arrondi à l'entier inférieur */
 poids_inf = floor(poids);
/* Arrondi à l'entier inférieur */
 poids_inf = ceil(poids);  
run;</code></pre>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier le plus proche</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>poids_arrondi_0 <span class="ot">&lt;-</span> <span class="fu">round</span>(donnees_rbase<span class="sc">$</span>poids, <span class="dv">0</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à 1 chiffre après la virgule</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>poids_arrondi_1 <span class="ot">&lt;-</span> <span class="fu">round</span>(donnees_rbase<span class="sc">$</span>poids, <span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à 2 chiffre après la virgule</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>poids_arrondi_2 <span class="ot">&lt;-</span> <span class="fu">round</span>(donnees_rbase<span class="sc">$</span>poids, <span class="dv">2</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier inférieur</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>poids_inf <span class="ot">&lt;-</span> <span class="fu">floor</span>(donnees_rbase<span class="sc">$</span>poids)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier inférieur</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>poids_inf <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(donnees_rbase<span class="sc">$</span>poids)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="les-tris" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="les-tris"><span class="header-section-number">10</span> Les tris</h2>
<section id="trier-par-colonne" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="trier-par-colonne"><span class="header-section-number">10.1</span> Trier par colonne</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<pre><code>/* On met identifiant date_entree et date_sortie au début de la base */
 %let colTri = identifiant date_entree;
data Donnees_sas;
  retain &amp;colTri.;
  set Donnees_sas;
run;
  
/* Autre solution */
 proc sql;
  create table Donnees_sas as 
  /* On remplace les blancs entre les mots par des virgules pour la proc SQL */
  /* Dans la proc SQL, les variables doivent être séparées par des virgules */
   select %sysfunc(tranwrd(&amp;colTri., %str( ), %str(, ))), * from Donnees_sas;
quit;</code></pre>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On met identifiant date_entree et date_sortie au début</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>colTri <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, <span class="fu">c</span>(colTri, <span class="fu">colnames</span>(donnees_rbase)[<span class="sc">!</span> <span class="fu">colnames</span>(donnees_rbase) <span class="sc">%in%</span> colTri])]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On met identifiant date_entree et date_sortie au début</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identifiant, date_entree, <span class="fu">everything</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="trier-les-lignes-par-ordre-croissant-ou-décroissant" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="trier-les-lignes-par-ordre-croissant-ou-décroissant"><span class="header-section-number">10.2</span> Trier les lignes par ordre croissant ou décroissant</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<pre><code>/* Trier la base par ligne (individu et date de début de la formation) par ordre décroissant : 2 possibilités */

proc sort data = Donnees_sas;by Identifiant Date_entree;run;
proc sql;create table Donnes as select * from Donnees_sas order by Identifiant, Date_entree;quit;
  
/* Idem par ordre croissant d'identifiant et ordre décroissant de date d'entrée*/

proc sort data = Donnees_sas;by Identifiant Date_entree descending;run;
proc sql;create table Donnes as select * from Donnees_sas order by Identifiant, desc Date_entree;quit;</code></pre>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trier la base par ligne (individu et date de début de la formation) par ordre croissant</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.last = FALSE (resp. TRUE) indique que les valeurs manquantes doivent figurer à la fin (resp. au début) du tri, que le tri</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co"># soit croissant ou décroissant</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant de identifiant et décroissant de date_entree (- avant le nom de la variable)</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_rbase &lt;- donnees_rbase[order(donnees_rbase$identifiant, -donnees_rbase$date_entree, na.last = FALSE), ]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trier la base par ligne (individu et date de début de la formation) par ordre croissant</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, date_entree)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant de identifiant et décroissant de date_entree </span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="fu">desc</span>(date_entree))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="incidence-des-valeurs-manquantes-dans-les-tris-différence-entre-sas-et-r" class="level3" data-number="10.3">
<h3 data-number="10.3" class="anchored" data-anchor-id="incidence-des-valeurs-manquantes-dans-les-tris-différence-entre-sas-et-r"><span class="header-section-number">10.3</span> Incidence des valeurs manquantes dans les tris, différence entre SAS et R</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false"><code>R base</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<pre><code>proc sort data = Donnees_sas;
by identifiant date_entree;run;
proc print
;run;

/* ... et en dernier selon un tri par ordre décroissant */

proc sort data = Donnees_sas;
by identifiant descending date_entree;
run;
proc print;
run;

/* En effet, les valeurs manquantes sont considérées comme des valeurs négatives */</code></pre>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs manquantes sont situées en dernier dans un tri par ordre croissant ou décroissant (car par défaut l'option na.last = TRUE) ...</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri SAS, il faut écrire :</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="manipuler-des-dates" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="manipuler-des-dates"><span class="header-section-number">11</span> Manipuler des dates</h2>
<section id="créer-une-date" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="créer-une-date"><span class="header-section-number">11.1</span> Créer une date</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<pre><code>data Donnees;
set Donnees;
/* Date de sortie du dispositif : ajout de la durée à la date d'entrée */
format date_sortie ddmmyy10.;
date_sortie = intnx('day', date_entree, duree);
run;</code></pre>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Date de sortie du dispositif</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie <span class="ot">&lt;-</span> donnees_rbase<span class="sc">$</span>date_entree <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(donnees_rbase<span class="sc">$</span>duree)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Date de sortie du dispositif</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_sortie =</span> date_entree <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(duree))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="calculer-des-durées" class="level3" data-number="11.2">
<h3 data-number="11.2" class="anchored" data-anchor-id="calculer-des-durées"><span class="header-section-number">11.2</span> Calculer des durées</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">

</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">

</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">

</div>
</div>
</div>
</section>
<section id="ajouter-une-durée-à-une-date" class="level3" data-number="11.3">
<h3 data-number="11.3" class="anchored" data-anchor-id="ajouter-une-durée-à-une-date"><span class="header-section-number">11.3</span> Ajouter une durée à une date</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">

</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">

</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">

</div>
</div>
</div>
</section>
</section>
<section id="manipuler-des-chaînes-de-caractères" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="manipuler-des-chaînes-de-caractères"><span class="header-section-number">12</span> Manipuler des chaînes de caractères</h2>
<section id="majuscule-minuscule" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="majuscule-minuscule"><span class="header-section-number">12.1</span> Majuscule, minuscule</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<pre><code>/*Première lettre en majuscule*/

  data Donnees_sas;
  set Donnees_sas;
  Niveau = propcase(Niveau);
  run;


/*Majuscule*/

  data Donnees_sas;
  set Donnees_sas;
  CSP_majuscule = upcase(CSPF);
  run;

/*Minuscule*/

  data Donnees_sas;
  set Donnees_sas;
  CSP_minuscule = lowcase(CSPF);
  run;</code></pre>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<ul>
<li>Première lettre en majuscule</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>niveau <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">toupper</span>(<span class="fu">substr</span>(donnees_rbase<span class="sc">$</span>niveau, <span class="dv">1</span>, <span class="dv">1</span>)), <span class="fu">tolower</span>(<span class="fu">substr</span>(donnees_rbase<span class="sc">$</span>niveau, <span class="dv">2</span>, <span class="fu">length</span>(donnees_rbase<span class="sc">$</span>niveau))))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in substr(donnees_rbase$niveau, 1, 1): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<ul>
<li>Majuscule</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>csp_maj <span class="ot">&lt;-</span> <span class="fu">toupper</span>(donnees_rbase<span class="sc">$</span>cspf)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in toupper(donnees_rbase$cspf): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<ul>
<li>Minuscule</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>csp_maj <span class="ot">&lt;-</span> <span class="fu">tolower</span>(donnees_rbase<span class="sc">$</span>cspf)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in tolower(donnees_rbase$cspf): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<ul>
<li>Première lettre en majuscule</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">niveau=</span><span class="fu">str_to_title</span>(niveau))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Majuscule</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">csp_maj=</span><span class="fu">toupper</span>(cspf))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Minuscule</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">csp_maj=</span><span class="fu">tolower</span>(cspf))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="remplacer-une-chaîne-de-catactère-par-une-autre" class="level3" data-number="12.2">
<h3 data-number="12.2" class="anchored" data-anchor-id="remplacer-une-chaîne-de-catactère-par-une-autre"><span class="header-section-number">12.2</span> Remplacer une chaîne de catactère par une autre</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false"><code>R base</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<pre><code>data Donnees_sas;
set Donnees_sas;
Niveau = tranwrd(Niveau, "Qualifie", "Qualifié");
run;</code></pre>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le mot qualifie n'a pas d'accent : on le corrige</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>niveau <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Qualifie"</span>, <span class="st">"Qualifié"</span>, donnees_rbase<span class="sc">$</span>niveau)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in is.factor(x): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="supprimer-des-blancs" class="level3" data-number="12.3">
<h3 data-number="12.3" class="anchored" data-anchor-id="supprimer-des-blancs"><span class="header-section-number">12.3</span> Supprimer des blancs</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-3" role="tab" aria-controls="tabset-27-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<pre><code>/* Manipuler des chaînes de caractères =&gt; R = gsub, grepl etc. */
data Exemple_chaines;
Texte = "              Ce   Texte   mériterait   d être   corrigé                  ";
Texte1 = "Je m'appelle";
Texte2 = "SAS";
run;
data Exemple_chaines;set Exemple_chaines;
/* Enlever les blancs au début et à la fin de la chaîne de caractère */
Enlever_Blancs_Initiaux = strip(Texte);
/* Enlever les doubles blancs dans la chaîne de caractères */
Enlever_Blancs_Entre = compbl(Enlever_Blancs_Initiaux);
run;</code></pre>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>texte_rbsase <span class="ot">&lt;-</span> <span class="st">"              Ce   Texte   mériterait   d être   corrigé                  "</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>texte_rbase_1 <span class="ot">&lt;-</span> <span class="st">"Je m'appelle"</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>texte_rbase_2 <span class="ot">&lt;-</span> <span class="st">"R"</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># trimws enlève les espaces au début et à la fin d'une chaîne de caractère</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>texte_rbase <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">" "</span>, <span class="fu">trimws</span>(texte_rbsase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-27-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>texte_tidyverse <span class="ot">&lt;-</span> <span class="st">"              Ce   Texte   mériterait   d être   corrigé                  "</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>texte_tidyverse_1 <span class="ot">&lt;-</span> <span class="st">"Je m'appelle"</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>texte_tidyverse_2 <span class="ot">&lt;-</span> <span class="st">"R"</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co"># str_squish() supprime les espaces blancs au début et à la fin, et remplace tous les espaces blancs internes par un seul espace</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>texte_tidyverse <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(texte_tidyverse)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="concaténer-des-chaînes-de-caractères" class="level3" data-number="12.4">
<h3 data-number="12.4" class="anchored" data-anchor-id="concaténer-des-chaînes-de-caractères"><span class="header-section-number">12.4</span> Concaténer des chaînes de caractères</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false"><code>R base</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<pre><code>/* Trois méthodes pour concaténer des chaînes de caractères */
Concatener  = Texte1||" "||Texte2;
Concatener2 = Texte1!!" "!!Texte2;
Concatener3 = catx(" ", Texte1, Texte2);
/* Extraire les 2e, 3e et 4e caractères de Concatener */
/* 2 correspond à la position du 1er caractère à récupérer, 3 le nombre total de caractères à partir du point de départ */
extrait = substr(Concatener, 2, 3);
run;</code></pre>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Concaténer des chaînes de caractères</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(texte_rbase_1, texte_rbase_2, <span class="at">sep =</span> <span class="st">" "</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="nombre-de-caractères-dans-une-chaîne-de-caractères" class="level3" data-number="12.5">
<h3 data-number="12.5" class="anchored" data-anchor-id="nombre-de-caractères-dans-une-chaîne-de-caractères"><span class="header-section-number">12.5</span> Nombre de caractères dans une chaîne de caractères</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-3" role="tab" aria-controls="tabset-29-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<pre><code>data Donnees;
set Donnees;
/* Nombre de caractères dans une chaîne de caractères*/
taille_id = length(identifiant);
run;</code></pre>
</div>
<div id="tabset-29-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de caractères dans une chaîne de caractères</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>taille_id <span class="ot">&lt;-</span> <span class="fu">nchar</span>(donnees_rbase<span class="sc">$</span>identifiant)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in nchar(donnees_rbase$identifiant): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-29-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de caractères dans une chaîne de caractères</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">taille_id =</span> <span class="fu">str_split</span>(identifiant, <span class="st">''</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>              lengths)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="transformer-plusieurs-caractères-différents" class="level3" data-number="12.6">
<h3 data-number="12.6" class="anchored" data-anchor-id="transformer-plusieurs-caractères-différents"><span class="header-section-number">12.6</span> Transformer plusieurs caractères différents</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<pre><code>/* Transformer plusieurs caractères différents */
chaine = "éèêëàâçîô";
/* On transforme le é en e, le â en a, le î en i, ... */
chaine_sans_accent = translate(chaine, "eeeeaacio", "éèêëàâçîô");
run;</code></pre>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer plusieurs caractères différents</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>chaine <span class="ot">&lt;-</span> <span class="st">"éèêëàâçîô"</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chartr</span>(<span class="st">"éèêëàâçîô"</span>, <span class="st">"eeeeaacio"</span>, chaine)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-30-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">

</div>
</div>
</div>
</section>
</section>
<section id="gestion-ligne-par-ligne" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="gestion-ligne-par-ligne"><span class="header-section-number">13</span> Gestion ligne par ligne</h2>
<section id="numéro-de-lobservation" class="level3" data-number="13.1">
<h3 data-number="13.1" class="anchored" data-anchor-id="numéro-de-lobservation"><span class="header-section-number">13.1</span> Numéro de l’observation</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-3" role="tab" aria-controls="tabset-31-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<pre><code>/* Numéro de l'observation */
data Donnees;set Donnees;
Num_observation = _n_;
run;

/* Autre solution */
proc sql noprint;select count(*) into :nbLignes from Donnees;quit;
data numLigne;do Num_observation = 1 to &amp;nbLignes.;output;end;run;</code></pre>
</div>
<div id="tabset-31-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro de l'observation : 2 manières différentes</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>num_observation <span class="ot">&lt;-</span> <span class="fu">row.names</span>(donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in row.names(donnees_rbase): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>num_observation <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(donnees_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in nrow(donnees_rbase): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-31-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_observation=</span> <span class="fu">row_number</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="trier-des-colonnes" class="level3" data-number="13.2">
<h3 data-number="13.2" class="anchored" data-anchor-id="trier-des-colonnes"><span class="header-section-number">13.2</span> Trier des colonnes</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-3" role="tab" aria-controls="tabset-32-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<pre><code>/* Numéro du contrat de chaque individu, contrat trié par date de survenue */
proc sort data = Donnees;by identifiant date_entree;run;
data Donnees;set Donnees;
by identifiant date_entree;
retain numero_contrat 0;
if first.identifiant then numero_contrat = 1;
else numero_contrat = numero_contrat + 1;
run;</code></pre>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro du contrat de chaque individu, contrat trié par date de survenue</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>a <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in donnees_rbase$a &lt;- 1: object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>numero_contrat <span class="ot">&lt;-</span> <span class="fu">ave</span>(donnees_rbase<span class="sc">$</span>a, donnees_rbase<span class="sc">$</span>identifiant, <span class="at">FUN =</span> cumsum)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in interaction(...): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour trier les colonnes</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>tri <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>, <span class="st">"numero_contrat"</span>, <span class="st">"num_observation"</span>)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase_tri <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(tri, <span class="fu">colnames</span>(donnees_rbase)[<span class="sc">!</span> <span class="fu">colnames</span>(donnees_rbase) <span class="sc">%in%</span> tri])]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-32-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro du contrat de chaque individu, contrat trié par date de survenue </span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">numero_contrat=</span><span class="fu">row_number</span>())</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange() va permettre de trier les observations par identifiant et date d'entrée </span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour trier les colonnes</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse_tri <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identifiant, date_entree, numero_contrat, num_observation, <span class="fu">everything</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="identifier-le-1er-le-2e-le-dernier-contrat-dun-individu" class="level3" data-number="13.3">
<h3 data-number="13.3" class="anchored" data-anchor-id="identifier-le-1er-le-2e-le-dernier-contrat-dun-individu"><span class="header-section-number">13.3</span> Identifier le 1er, le 2e, le dernier contrat d’un individu</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-33-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-1" role="tab" aria-controls="tabset-33-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-2" role="tab" aria-controls="tabset-33-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-3" role="tab" aria-controls="tabset-33-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-33-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-33-1-tab">
<pre><code>/* 2e contrat de l'individu (et rien si l'individu a fait 1 seul contrat */
data Deuxieme_Contrat;set Donnees;if numero_contrat = 2;run;
data Deuxieme_Contrat;set Donnees (where = (numero_contrat = 2));run;</code></pre>
</div>
<div id="tabset-33-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtre sur le deuxième contrat </span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>deuxieme_contrat_rbase <span class="ot">&lt;-</span> donnees_rbase[donnees_rbase<span class="sc">$</span>numero_contrat <span class="sc">==</span> <span class="dv">2</span>, ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une base avec les seuls premiers contrats, et une base avec les seuls derniers contrats</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>premier_contrat_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>dernier_contrat_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>ni_prem_ni_der_rbase  <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span> (<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>)), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-33-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtre sur le deuxième contrat </span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>deuxieme_contrat_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numero_contrat <span class="sc">==</span> <span class="dv">2</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une base avec les seuls premiers contrats, et une base avec les seuls derniers contrats</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>premier_contrat_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numero_contrat<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>dernier_contrat_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numero_contrat<span class="sc">==</span><span class="fu">max</span>(numero_contrat)) <span class="sc">%&gt;%</span> </span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>ni_prem_ni_der_tidyverse  <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numero_contrat<span class="sc">!=</span><span class="dv">1</span> <span class="sc">&amp;</span> numero_contrat <span class="sc">!=</span> <span class="fu">max</span>(numero_contrat)) <span class="sc">%&gt;%</span> </span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="date-de-fin-du-contrat-précédent" class="level3" data-number="13.4">
<h3 data-number="13.4" class="anchored" data-anchor-id="date-de-fin-du-contrat-précédent"><span class="header-section-number">13.4</span> Date de fin du contrat précédent</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-34-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-1" role="tab" aria-controls="tabset-34-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-2" role="tab" aria-controls="tabset-34-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-3" role="tab" aria-controls="tabset-34-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-34-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-34-1-tab">
<pre><code>/* La date de fin du contrat précédent */
proc sort data = Donnees;by identifiant date_entree;run;
data DonneesBon;set Donnees;
by identifiant date_entree;
format Date_fin_1 ddmmyy10.;
Date_fin_1 = lag(Date_sortie);
if first.identifiant then Date_fin_1 = .;
run;</code></pre>
</div>
<div id="tabset-34-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Il faut soit utiliser un package, soit utiliser cette astuce car il n'existe pas de fonction lag dans le R de base (à notre connaissance)</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="cn">NA</span>), donnees_rbase<span class="sc">$</span>date_sortie[ <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(donnees_rbase<span class="sc">$</span>date_sortie) <span class="sc">-</span> <span class="dv">1</span>)])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie_1[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>)] <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="cn">NA</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in donnees_rbase$date_sortie_1[!duplicated(donnees_rbase$identifiant, : object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-34-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-3-tab">

</div>
</div>
</div>
</section>
<section id="valeur-retardée-lag" class="level3" data-number="13.5">
<h3 data-number="13.5" class="anchored" data-anchor-id="valeur-retardée-lag"><span class="header-section-number">13.5</span> Valeur retardée (lag)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-35-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-1" role="tab" aria-controls="tabset-35-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-2" role="tab" aria-controls="tabset-35-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-3" role="tab" aria-controls="tabset-35-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-35-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-35-1-tab">
<pre><code>/* ATTENTION au lag DANS UNE CONDITION IF (cf. document) */
proc sort data = Donnees;by identifiant date_entree;run;
data Lag_Bon;set Donnees (keep = identifiant date_entree date_sortie);
format date_sortie_1 lag_faux lag_bon ddmmyy10.;
/* Erreur */
if date_entree = lag(date_sortie) + 1 then lag_faux = lag(date_sortie) + 1;
/* Bonne écriture */
date_sortie_1 = lag(date_sortie);
if date_entree = date_sortie_1 + 1 then lag_bon = date_sortie_1 + 1;
run;</code></pre>
</div>
<div id="tabset-35-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Il n'existe pas de fonction lag dans le R de base (à notre connaissance)</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Il faut soit utiliser un package, soit utiliser cette astuce</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="cn">NA</span>), donnees_rbase<span class="sc">$</span>date_sortie[ <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(donnees_rbase<span class="sc">$</span>date_sortie) <span class="sc">-</span> <span class="dv">1</span>)])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie_1[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>)] <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="cn">NA</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in donnees_rbase$date_sortie_1[!duplicated(donnees_rbase$identifiant, : object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-35-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_sortie_1 =</span> <span class="fu">lag</span>(date_sortie))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="transposer-une-base" class="level3" data-number="13.6">
<h3 data-number="13.6" class="anchored" data-anchor-id="transposer-une-base"><span class="header-section-number">13.6</span> Transposer une base</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-36-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-1" role="tab" aria-controls="tabset-36-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-2" role="tab" aria-controls="tabset-36-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-3" role="tab" aria-controls="tabset-36-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-36-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-36-1-tab">
<pre><code>/* Transposer une base */
proc freq data = Donnees;table Sexef * cspf / out = Nb;run;
proc sort data = Nb;by cspf Sexef;run;
proc print data = Nb;run;
proc transpose data = Nb out = transpose;by cspf;var count;id Sexef;run;
data transpose;set transpose (drop = _name_ _label_);run;
proc print data = transpose;run;</code></pre>
</div>
<div id="tabset-36-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as.data.frame.matrix est nécessaire, car le résultat de xtabs est un array</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>nb_rbase <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(<span class="fu">xtabs</span>( <span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in terms.formula(formula, data = data): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>nb_transpose_rbase <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(nb_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in t(nb_rbase): object 'nb_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-36-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>nb_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">tabyl</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># colonne cspf comme nom de ligne</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">"cspf"</span>)</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>nb_transpose_tridyverse <span class="ot">&lt;-</span> nb_tidyverse <span class="sc">%&gt;%</span> sjmisc<span class="sc">::</span><span class="fu">rotate_df</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="les-valeurs-manquantes" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="les-valeurs-manquantes"><span class="header-section-number">14</span> Les valeurs manquantes</h2>
<section id="repérer-les-valeurs-manquantes" class="level3" data-number="14.1">
<h3 data-number="14.1" class="anchored" data-anchor-id="repérer-les-valeurs-manquantes"><span class="header-section-number">14.1</span> Repérer les valeurs manquantes</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-37-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-1" role="tab" aria-controls="tabset-37-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-2" role="tab" aria-controls="tabset-37-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-3" role="tab" aria-controls="tabset-37-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-37-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-37-1-tab">
<pre><code>/* Repérer les valeurs manquantes */
data Missing;set Donnees;
/* 1ère solution */
if missing(age) or missing(Niveau) then missing1 = 1;else missing1 = 0;
if age = . or Niveau = '' then missing2 = 1;else missing2 = 0;
keep Age Niveau Missing1 Missing2;
run;</code></pre>
</div>
<div id="tabset-37-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>missing <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(donnees_rbase<span class="sc">$</span>age) <span class="sc">|</span> <span class="fu">is.na</span>(donnees_rbase<span class="sc">$</span>niveau), <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in ifelse(is.na(donnees_rbase$age) | is.na(donnees_rbase$niveau), : object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>ageManquant_rbase_faux <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">is.na</span>(donnees_rbase<span class="sc">$</span>age),  ] <span class="co"># Faux : crée une basse de données avec que des NA</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>ageManquant_rbase_correct <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">is.na</span>(donnees_rbase<span class="sc">$</span>age), ] <span class="co"># Correct</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-37-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(age) <span class="sc">|</span> <span class="fu">is.na</span>(niveau), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>ageManquant_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(age))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="incidence-des-valeurs-manquantes-différent-entre-sas-et-r" class="level3" data-number="14.2">
<h3 data-number="14.2" class="anchored" data-anchor-id="incidence-des-valeurs-manquantes-différent-entre-sas-et-r"><span class="header-section-number">14.2</span> Incidence des valeurs manquantes, différent entre SAS et R</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-38-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-1" role="tab" aria-controls="tabset-38-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-2" role="tab" aria-controls="tabset-38-2" aria-selected="false"><code>R base</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-38-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-38-1-tab">

</div>
<div id="tabset-38-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-2-tab">
<section id="opérations" class="level4" data-number="14.2.1">
<h4 data-number="14.2.1" class="anchored" data-anchor-id="opérations"><span class="header-section-number">14.2.1</span> Opérations</h4>
<p>Il suffit de rajouter l’argument <em>na.rm=TRUE</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donnees_rbase<span class="sc">$</span>note_formateur) <span class="co"># s'il existe un seul NA et que l'on ne précise rien, la fonction retournera NA</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in mean(donnees_rbase$note_formateur): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Il faut donc rajouter l'argument na.rm=TRUE (remove NA) afin de calculer la moyenne sans prendre en compte les NA</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donnees_rbase<span class="sc">$</span>note_formateur, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in mean(donnees_rbase$note_formateur, na.rm = TRUE): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</section>
<section id="tris" class="level4" data-number="14.2.2">
<h4 data-number="14.2.2" class="anchored" data-anchor-id="tris"><span class="header-section-number">14.2.2</span> Tris</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trier la base par ligne (individu et date de début de la formation) par ordre croissant</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.last = FALSE (resp. TRUE) indique que les valeurs manquantes doivent figurer à la fin (resp. au début) du tri, que le tri</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="co"># soit croissant ou décroissant</span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant de identifiant et décroissant de date_entree (- avant le nom de la variable)</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="co"># donnees_rbase &lt;- donnees_rbase[order(donnees_rbase$identifiant, -donnees_rbase$date_entree, na.last = FALSE), ] #ne marche pas pour les dates à refaire</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trier la base par colonne (noms de variables)</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On met identifiant date_entree et date_sortie au début</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="co"># colTri &lt;- c("identifiant", "date_entree", "date_sortie")</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="co"># donnees_rbase[, c(colTri, colnames(donnees_rbase)[! colnames(donnees_rbase) %in% colTri])]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs manquantes sont situées en dernier dans un tri par ordre croissant ou décroissant (car par défaut l'option na.last = TRUE) ...</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri SAS, il faut écrire :</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="les-doublons" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="les-doublons"><span class="header-section-number">15</span> Les doublons</h2>
<section id="repérage-des-doublons" class="level3" data-number="15.1">
<h3 data-number="15.1" class="anchored" data-anchor-id="repérage-des-doublons"><span class="header-section-number">15.1</span> Repérage des doublons</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-39-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-1" role="tab" aria-controls="tabset-39-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-2" role="tab" aria-controls="tabset-39-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-3" role="tab" aria-controls="tabset-39-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-39-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-39-1-tab">
<pre><code>/* On récupère déjà la dernière variable de la base (on en aura besoin plus loin) */
proc contents data = Donnees out = Var noprint;run;
proc sql noprint;select name into :derniere_var from Var where varnum = (select max(varnum) from Var);quit;

/* 1ère méthode */
proc sort data = Donnees;by &amp;nom_col.;run;
data Doublons;set Donnees;by &amp;nom_col.;
if first.&amp;derniere_var. = 0 or last.&amp;derniere_var. = 0;
run;

/* 2e méthode */

/* On remplace les blancs entre les mots par des virgules pour la proc sql */

/* Dans la proc SQL, les variables doivent être séparées par des virgules */
%let nom_col_sql = %sysfunc(tranwrd(&amp;nom_col., %str( ), %str(, )));

/* On groupe par toutes les colonnes, et si on aboutit à strictement plus qu'une ligne, c'est un doublon */
proc sql;create table Doublons as select * from Donnees group by &amp;nom_col_sql. having count(*) &gt; 1;quit;

/* Suppression des doublons */

/* 1ère méthode */
proc sort data = Donnees nodupkey;by &amp;nom_col.;run;

/* 2e méthode, avec first. et last. (cf. infra) */

/* On récupère déjà la dernière variable de la base (on en aura besoin plus loin) */
proc contents data = Donnees out = Var noprint;run;
proc sql noprint;select name into :derniere_var from Var where varnum = (select max(varnum) from Var);quit;
proc sql noprint;select name into :nom_col separated by " " from Var order by varnum;quit;
%put Dernière variable de la base : &amp;derniere_var.;
%put &amp;nom_col.;
proc sort data = Donnees;by &amp;nom_col.;run;
data Donnees;set Donnees;by &amp;nom_col.;if first.&amp;derniere_var.;run;</code></pre>
</div>
<div id="tabset-39-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repérage</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>doublons_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">duplicated</span>(donnees_rbase), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co">#doublons ici : toute la ligne est identique avec une autre ligne </span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="co">#avec cette commande, s'il y existe des doublons i.e. deux observations qui ont les mêmes observations pour toutes les variables, la base doublons_rbase stockera uniquement un des doublons mais pas toutes les lignes qui sont identiques </span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-39-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repérage</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>doublons_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant, sexe) <span class="sc">%&gt;%</span> </span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="co">#doublons ici : les observations qui ont le même identifiant et le même sexe </span></span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="co">#avec cette commande, la base doublons_tidyverse va stocker toutes les observations qui sont en doubles i.e. qui ont le même identifiant et le même sexe </span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="suppression-des-doublons" class="level3" data-number="15.2">
<h3 data-number="15.2" class="anchored" data-anchor-id="suppression-des-doublons"><span class="header-section-number">15.2</span> Suppression des doublons</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-40-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-1" role="tab" aria-controls="tabset-40-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-2" role="tab" aria-controls="tabset-40-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-3" role="tab" aria-controls="tabset-40-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-40-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-40-1-tab">

</div>
<div id="tabset-40-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span> <span class="fu">duplicated</span>(donnees_rbase), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution (solution first. de SAS)</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(<span class="fu">colnames</span>(donnees_rbase), <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase[, <span class="fu">colnames</span>(donnees_rbase)], <span class="at">fromLast =</span> <span class="cn">TRUE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-40-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="les-jointures-de-base" class="level2" data-number="16">
<h2 data-number="16" class="anchored" data-anchor-id="les-jointures-de-base"><span class="header-section-number">16</span> Les jointures de base</h2>
<section id="inner-join-identifiants-communs-aux-bases" class="level3" data-number="16.1">
<h3 data-number="16.1" class="anchored" data-anchor-id="inner-join-identifiants-communs-aux-bases"><span class="header-section-number">16.1</span> Inner Join : identifiants communs aux bases</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-41-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-1" role="tab" aria-controls="tabset-41-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-2" role="tab" aria-controls="tabset-41-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-3" role="tab" aria-controls="tabset-41-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-41-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-41-1-tab">
<pre><code>/* On suppose que l'on dispose d'une base supplémentaire avec les diplômes des personnes */
data Diplome;
infile cards dsd dlm='|';
format Identifiant $3. Diplome $50.;
input Identifiant $ Diplome $;
cards;
173|Bac
168|Bep-Cap
112|Bep-Cap
087|Bac+2
689|Bac+2
765|Pas de diplôme
112|Bac
999|Bac
554|Bep-Cap
;
run;
data Jointure;set Donnees (keep = Identifiant Sexe Age);run;

/* Le tri préalable des bases de données à joindre par la variable de jointure est nécessaire avec la stratégie merge */
proc sort data = Diplome;by identifiant;run;
proc sort data = Jointure;by identifiant;run;
data Inner_Join1;
merge Jointure (in = a) Diplome (in = b);
by identifiant;
if a and b;
run;

/* Le tri préalable des bases de données à joindre n'est pas nécessaire avec la jointure SQL */
proc sql;
create table Inner_Join2 as
select * from Jointure a inner join Diplome b on a.identifiant = b.identifiant
order by a.identifiant;
quit;
proc print data = Inner_Join1;run;
proc sql;select count(*) from Inner_Join1;quit;</code></pre>
</div>
<div id="tabset-41-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On suppose que l'on dispose d'une base supplémentaire avec les diplômes des personnes</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>diplome_rbase <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">identifiant_i =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"168"</span>, <span class="st">"112"</span>, <span class="st">"087"</span>, <span class="st">"689"</span>, <span class="st">"765"</span>, <span class="st">"112"</span>, <span class="st">"999"</span>, <span class="st">"554"</span>),</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="at">diplome=</span> <span class="fu">c</span>(<span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Pas de diplôme"</span>, <span class="st">"Bac"</span>, <span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>),</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="at">age_dip =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">15</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">20</span>)</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Inner join : les seuls identifiants communs aux deux bases</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>jointure_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"sexe"</span>, <span class="st">"age"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>innerJoin_rbase <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_rbase, diplome_rbase, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant_i"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in merge(jointure_rbase, diplome_rbase, by.x = "identifiant", by.y = "identifiant_i"): object 'jointure_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'innerJoin_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-41-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On suppose que l'on dispose d'une base supplémentaire avec les diplômes des personnes</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>diplome_tidyverse <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">identifiant=</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"168"</span>, <span class="st">"112"</span>, <span class="st">"087"</span>, <span class="st">"689"</span>, <span class="st">"765"</span>, <span class="st">"112"</span>, <span class="st">"999"</span>, <span class="st">"554"</span>),</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="at">diplome=</span> <span class="fu">c</span>(<span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Pas de diplôme"</span>, <span class="st">"Bac"</span>, <span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>),</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="at">age_dip =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">15</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">20</span>)</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Inner join : les seuls identifiants communs aux deux bases</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>jointure_tidyverse<span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identifiant, sexe, age)</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>innerJoin_tidyverse <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(diplome_tidyverse, <span class="at">by=</span><span class="st">"identifiant"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="left-et-right-join-identifiants-de-lune-des-bases" class="level3" data-number="16.2">
<h3 data-number="16.2" class="anchored" data-anchor-id="left-et-right-join-identifiants-de-lune-des-bases"><span class="header-section-number">16.2</span> Left et Right Join : identifiants de l’une des bases</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-42-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-1" role="tab" aria-controls="tabset-42-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-2" role="tab" aria-controls="tabset-42-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-3" role="tab" aria-controls="tabset-42-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-42-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-42-1-tab">
<pre><code>/* Le tri préalable des bases de données à joindre par la variable de jointure est nécessaire avec la stratégie merge */
proc sort data = Diplome;by identifiant;run;
proc sort data = Jointure;by identifiant;run;
data Left_Join1;
merge Jointure (in = a) Diplome (in = b);
by identifiant;
if a;
run;</code></pre>
</div>
<div id="tabset-42-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Left join : les identifiants de la base de gauche</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>leftJoin_rbase <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_rbase, diplome_rbase, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant_i"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in merge(jointure_rbase, diplome_rbase, by.x = "identifiant", by.y = "identifiant_i", : object 'jointure_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(leftJoin_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'leftJoin_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-42-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Left join : les identifiants de la base de gauche</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>leftJoin_tidyverse <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(diplome_tidyverse, <span class="at">by=</span><span class="st">"identifiant"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="full-join-identifiants-de-lune-ou-lautre-des-bases" class="level3" data-number="16.3">
<h3 data-number="16.3" class="anchored" data-anchor-id="full-join-identifiants-de-lune-ou-lautre-des-bases"><span class="header-section-number">16.3</span> Full Join : identifiants de l’une ou l’autre des bases</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-43-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-1" role="tab" aria-controls="tabset-43-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-2" role="tab" aria-controls="tabset-43-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-3" role="tab" aria-controls="tabset-43-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-43-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-43-1-tab">
<pre><code>/* Le tri préalable des bases de données à joindre par la variable de jointure est nécessaire avec la stratégie merge */
proc sort data = Diplome;by identifiant;run;
proc sort data = Jointure;by identifiant;run;
data Full_Join1;
merge Jointure (in = a) Diplome (in = b);
by identifiant;
if a or b;
run;</code></pre>
</div>
<div id="tabset-43-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-43-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Full join : les identifiants des deux bases</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>fullJoin_rbase <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_rbase, diplome_rbase, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant_i"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in merge(jointure_rbase, diplome_rbase, by.x = "identifiant", by.y = "identifiant_i", : object 'jointure_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fullJoin_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'fullJoin_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-43-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-43-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Full join : les identifiants des deux bases</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>fullJoin_tidyverse <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(diplome_tidyverse)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="cross-join-toutes-les-combinaisons-possibles" class="level3" data-number="16.4">
<h3 data-number="16.4" class="anchored" data-anchor-id="cross-join-toutes-les-combinaisons-possibles"><span class="header-section-number">16.4</span> Cross Join : toutes les combinaisons possibles</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-44-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-1" role="tab" aria-controls="tabset-44-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-2" role="tab" aria-controls="tabset-44-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-3" role="tab" aria-controls="tabset-44-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-44-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-44-1-tab">
<pre><code>/* 4. Cross join : toutes les combinaisons possibles de CSP, sexe et Diplome */
proc sql;
select *
from (select distinct CSPF from Donnees) cross join (select distinct Sexef from Donnees) cross join (select distinct Diplome from Diplome)
order by CSPF, Sexef, Diplome;
quit;</code></pre>
</div>
<div id="tabset-44-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Cross join : toutes les combinaisons possibles de CSP, sexe et Diplome</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>crossJoin_rbase <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">expand.grid</span>(donnees_rbase<span class="sc">$</span>cspf, donnees_rbase<span class="sc">$</span>sexef, diplome_rbase<span class="sc">$</span>diplome))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in expand.grid(donnees_rbase$cspf, donnees_rbase$sexef, diplome_rbase$diplome): object 'donnees_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(crossJoin_rbase) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="st">"diplome"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in colnames(crossJoin_rbase) &lt;- c("cspf", "sexef", "diplome"): object 'crossJoin_rbase' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>crossJoin_rbase</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'crossJoin_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-44-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Cross join </span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>crossJoin_tidyverse <span class="ot">&lt;-</span> <span class="fu">cross_join</span>(jointure_tidyverse, diplome_tidyverse) <span class="co">#à refaire</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="empiler-les-bases" class="level3" data-number="16.5">
<h3 data-number="16.5" class="anchored" data-anchor-id="empiler-les-bases"><span class="header-section-number">16.5</span> Empiler les bases</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-45-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-1" role="tab" aria-controls="tabset-45-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-2" role="tab" aria-controls="tabset-45-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-3" role="tab" aria-controls="tabset-45-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-45-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-45-1-tab">

</div>
<div id="tabset-45-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lorsque les variables ne correspondent pas, on les crée avec des valeurs manquantes, via setdiff</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>empilement_rbase <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">c</span>(donnees_rbase, <span class="fu">sapply</span>(<span class="fu">setdiff</span>(<span class="fu">names</span>(diplome_rbase), <span class="fu">names</span>(donnees_rbase)), <span class="cf">function</span>(x) <span class="cn">NA</span>))),</span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">c</span>(diplome_rbase, <span class="fu">sapply</span>(<span class="fu">setdiff</span>(<span class="fu">names</span>(donnees_rbase), <span class="fu">names</span>(diplome_rbase)), <span class="cf">function</span>(x) <span class="cn">NA</span>)))</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(c(donnees_rbase, sapply(setdiff(names(diplome_rbase), : object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-45-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bind_rows permet d'empiler les deux bases de données quel que soit l'ordre et le nombre respectif de colonnes alors que rbind ne fonctionnera pas si les bases de données n'ont pas les mêmes colonnes dans le même ordre. </span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>empilement_tidyverse <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(donnees_tidyverse, diplome_tidyverse)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="statistiques-descriptives" class="level2" data-number="17">
<h2 data-number="17" class="anchored" data-anchor-id="statistiques-descriptives"><span class="header-section-number">17</span> Statistiques descriptives</h2>
<section id="somme-moyenne-médiane-minimum-maximum-nombre-de-valeurs" class="level3" data-number="17.1">
<h3 data-number="17.1" class="anchored" data-anchor-id="somme-moyenne-médiane-minimum-maximum-nombre-de-valeurs"><span class="header-section-number">17.1</span> Somme, moyenne, médiane, minimum, maximum, nombre de valeurs</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-46-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-1" role="tab" aria-controls="tabset-46-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-2" role="tab" aria-controls="tabset-46-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-3" role="tab" aria-controls="tabset-46-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-46-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-46-1-tab">
<pre><code>/* Moyenne de chaque note */
%let notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;
proc means data = Donnees mean;var &amp;notes.;run;

/* Somme, moyenne, médiane, minimum, maximum, nombre de données */
proc means data = Donnees sum mean median min max n;var &amp;notes.;run;

/* Notes pondérées (poids de sondage) */
proc means data = Donnees sum mean median min max n;var &amp;notes.;weight poids_sondage;run;</code></pre>
</div>
<div id="tabset-46-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-2-tab">
<ul>
<li>Moyenne</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne de chaque note</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>notes_rbase <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(donnees_rbase[, notes_rbase], mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lapply(donnees_rbase[, notes_rbase], mean, na.rm = TRUE): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<ul>
<li>Moyenne, médiane, maximum, minimum</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(donnees_rbase[, notes], <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="st">"Somme"</span> <span class="ot">=</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"Moyenne"</span> <span class="ot">=</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="st">"Médiane"</span> <span class="ot">=</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"Max"</span> <span class="ot">=</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="st">"Min"</span> <span class="ot">=</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lapply(X = X, FUN = FUN, ...): object 'donnees_rbase' not found</code></pre>
</div>
</div>
<ul>
<li>Moyenne avec pondération</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la pondération</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, <span class="fu">sapply</span>(donnees_rbase[, notes], <span class="cf">function</span>(x) <span class="fu">weighted.mean</span>(x, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in with(donnees_rbase, sapply(donnees_rbase[, notes], function(x) weighted.mean(x, : object 'donnees_rbase' not found</code></pre>
</div>
</div>
<ul>
<li>Résumé statistique</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(donnees_rbase[, notes])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in summary(donnees_rbase[, notes]): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-46-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-3-tab">
<ul>
<li>Moyenne par identifiant</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>notes_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Note"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">c</span>(<span class="at">mean=</span><span class="st">"mean"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Moyenne par identifiant par pondération</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>notes_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Note"</span>), poids_sondage) <span class="sc">%&gt;%</span> </span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(note_contenu<span class="sc">:</span>note_materiel, <span class="sc">~</span><span class="fu">weighted.mean</span>(., <span class="at">w =</span> poids_sondage)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="quantiles" class="level3" data-number="17.2">
<h3 data-number="17.2" class="anchored" data-anchor-id="quantiles"><span class="header-section-number">17.2</span> Quantiles</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-47-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-1" role="tab" aria-controls="tabset-47-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-2" role="tab" aria-controls="tabset-47-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-3" role="tab" aria-controls="tabset-47-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-47-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-47-1-tab">

</div>
<div id="tabset-47-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-47-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Déciles et quartiles de la note moyenne</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(donnees_rbase<span class="sc">$</span>note_moyens, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in quantile(donnees_rbase$note_moyens, probs = c(seq(0, 1, 0.1), : object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-47-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-47-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span>  </span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quantile =</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)),</span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">note_moyens =</span> <span class="fu">quantile</span>(note_moyens, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="tableaux-de-fréquence-contingence-proc-freq" class="level3" data-number="17.3">
<h3 data-number="17.3" class="anchored" data-anchor-id="tableaux-de-fréquence-contingence-proc-freq"><span class="header-section-number">17.3</span> Tableaux de fréquence / contingence : proc freq</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-48-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-1" role="tab" aria-controls="tabset-48-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-2" role="tab" aria-controls="tabset-48-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-3" role="tab" aria-controls="tabset-48-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-48-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-48-1-tab">
<pre><code>/* Tableaux de fréquence : proc freq */
proc freq data = Donnees;
tables Sexe CSP / missing;
format Sexe sexef. CSP $cspf.;
/*weight poids_sondage;*/
run;</code></pre>
</div>
<div id="tabset-48-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-48-2-tab">
<p>L’équivalent de <em>proc freq</em> sur SAS :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees_rbase<span class="sc">$</span>sexef, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in table(donnees_rbase$sexef, useNA = "always"): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-48-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-48-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>tableau_contingence <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>tableau_contingence</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="proportion" class="level3" data-number="17.4">
<h3 data-number="17.4" class="anchored" data-anchor-id="proportion"><span class="header-section-number">17.4</span> Proportion</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-49-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-1" role="tab" aria-controls="tabset-49-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-2" role="tab" aria-controls="tabset-49-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-3" role="tab" aria-controls="tabset-49-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-49-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-49-1-tab">

</div>
<div id="tabset-49-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-49-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(donnees_rbase<span class="sc">$</span>sexef, <span class="at">useNA =</span> <span class="st">"always"</span>)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in table(donnees_rbase$sexef, useNA = "always"): object 'donnees_rbase' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-49-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-49-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>proportion <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">pourcentage=</span><span class="fu">round</span>(n<span class="sc">/</span><span class="fu">length</span>(donnees_tidyverse<span class="sc">$</span>sexef)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>))</span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>proportion</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="fonction-macros-sas" class="level2" data-number="18">
<h2 data-number="18" class="anchored" data-anchor-id="fonction-macros-sas"><span class="header-section-number">18</span> Fonction, macros SAS</h2>
<section id="boucles-itérations" class="level3" data-number="18.1">
<h3 data-number="18.1" class="anchored" data-anchor-id="boucles-itérations"><span class="header-section-number">18.1</span> Boucles, itérations</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-50-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-1" role="tab" aria-controls="tabset-50-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-2" role="tab" aria-controls="tabset-50-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-3" role="tab" aria-controls="tabset-50-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-50-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-50-1-tab">

</div>
<div id="tabset-50-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-50-2-tab">

</div>
<div id="tabset-50-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-50-3-tab">

</div>
</div>
</div>
</section>
<section id="créations-automatiques-de-bases-empilements-de-bases" class="level3" data-number="18.2">
<h3 data-number="18.2" class="anchored" data-anchor-id="créations-automatiques-de-bases-empilements-de-bases"><span class="header-section-number">18.2</span> Créations automatiques de bases, empilements de bases</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-51-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-1" role="tab" aria-controls="tabset-51-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-51-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-2" role="tab" aria-controls="tabset-51-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-51-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-3" role="tab" aria-controls="tabset-51-3" aria-selected="false"><code>tidyverse</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-51-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-51-1-tab">

</div>
<div id="tabset-51-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-51-2-tab">

</div>
<div id="tabset-51-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-51-3-tab">

</div>
</div>
</div>
</section>
</section>
<section id="fin-du-programme" class="level2" data-number="19">
<h2 data-number="19" class="anchored" data-anchor-id="fin-du-programme"><span class="header-section-number">19</span> Fin du programme</h2>
<section id="supprimer-toutes-les-bases-de-la-mémoire-vive-work-ram" class="level3" data-number="19.1">
<h3 data-number="19.1" class="anchored" data-anchor-id="supprimer-toutes-les-bases-de-la-mémoire-vive-work-ram"><span class="header-section-number">19.1</span> Supprimer toutes les bases de la mémoire vive (work RAM)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-52-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-1" role="tab" aria-controls="tabset-52-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-52-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-2" role="tab" aria-controls="tabset-52-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-52-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-3" role="tab" aria-controls="tabset-52-3" aria-selected="false"><code>Duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-52-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-52-1-tab">
<pre><code>/* Supprimer toutes les bases de la mémoire vive (la work) =&gt; rm(list = ls()) */
proc datasets lib = work nolist kill;run;</code></pre>
</div>
<div id="tabset-52-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-52-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-52-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-52-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'conn' in selecting a method for function 'dbDisconnect': object 'con' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="points-de-vigilance-en-sas" class="level2" data-number="20">
<h2 data-number="20" class="anchored" data-anchor-id="points-de-vigilance-en-sas"><span class="header-section-number">20</span> Points de vigilance en SAS</h2>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notes de bas de page</h2>

<ol>
<li id="fn1"><p>Dares/DIP, damien.euzenat@travail.gouv.fr<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Dares/DFA, sebastien.li-thiao-te@travail.gouv.fr<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Dares/SCS, nassab.abdallah@travail.gouv.fr<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Dares/DIP, damien.euzenat@travail.gouv.fr<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Dares/DFA, sebastien.li-thiao-te@travail.gouv.fr<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Ce site a été créé avec <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>